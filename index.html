<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kindred 대화형 단어장 (Firebase 버전)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Noto Sans KR',sans-serif; background:#f8fafc; }
    .tab-active{border-color:#4f46e5;color:#4f46e5;background:#eef2ff;font-weight:600}
    .nav-tab{transition:.2s;border-radius:.5rem;flex-shrink:0}
    .quiz-option.correct{background:#dcfce7;border-color:#22c55e}
    .quiz-option.incorrect{background:#fee2e2;border-color:#ef4444}
    #word-modal{transition:opacity .3s}
    #modal-content{transition:transform .3s}
    #game-canvas{
  background:linear-gradient(to bottom,#1e3a8a,#3730a3);
  border-radius:.5rem;border:2px solid #a5b4fc;
  display:block; margin:0 auto;      /* 중앙 정렬 */
  width:100%; height:auto; aspect-ratio:8/5; /* 자동 비율 */
  max-width:100%;
  max-height:calc((100vh - 220px)*0.7);
}
@supports (height: 1svh){
  #game-canvas{ max-height: calc((100svh - 220px)*0.7); }
}
    .bookmark-icon.bookmarked{color:#f59e0b}
    .flashcard-container{perspective:1000px}
    .flashcard{transition:transform .6s;transform-style:preserve-3d}
    .flashcard.is-flipped{transform:rotateY(180deg)}
    .flashcard-front,.flashcard-back{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;width:100%;height:100%}
    .flashcard-back{transform:rotateY(180deg)}
    .nav-container::-webkit-scrollbar{display:none}
    .nav-container{-ms-overflow-style:none;scrollbar-width:none}
    .ranking-item{transition:all .3s}
    .ranking-item:hover{transform:translateY(-2px);box-shadow:0 10px 25px rgba(0,0,0,.1)}
    .rank-1{background:linear-gradient(135deg,#ffd700,#ffed4e)}
    .rank-2{background:linear-gradient(135deg,#c0c0c0,#e5e5e5)}
    .rank-3{background:linear-gradient(135deg,#cd7f32,#daa520)}

  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <div id="app" class="container mx-auto p-4 md:p-8 max-w-7xl">
    <header class="text-center mb-10">
      <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-indigo-700">Kindred Vocabulary</h1>
      <p class="text-slate-600 mt-3 text-base sm:text-lg">옥타비아 버틀러의 소설 '킨드레드'를 통해 영어를 깊이 있게 탐험하세요.</p>
    </header>

    <div class="nav-container overflow-x-auto whitespace-nowrap bg-slate-100 p-2 rounded-xl mb-8 shadow-sm">
      <nav class="flex gap-2">
        <button data-tab="home" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">홈</button>
        <button data-tab="vocabCards" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">단어</button>
        <button data-tab="flashcards" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">플래시카드</button>
        <button data-tab="bookmarks" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">북마크</button>
        <button data-tab="quiz" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">단어 퀴즈</button>
        <button data-tab="game" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">타이핑 게임</button>
        <button data-tab="ranking" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">랭킹</button>
        <button data-tab="vocabTable" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">단어목록</button>
      
        <button data-tab="guestbook" class="nav-tab px-5 py-2.5 border-b-2 border-transparent text-slate-600 hover:bg-white hover:text-indigo-600">방명록</button>
      </nav>
    </div>

    <main id="content-area"></main>
  </div>

  <!-- 단어 상세 모달 -->
  <div id="word-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden z-50">
    <div id="modal-content" class="bg-white rounded-xl shadow-2xl p-6 sm:p-8 max-w-2xl w-full relative transform scale-95"></div>
  </div>

  <!-- 점수 저장 모달 -->
  <div id="score-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden z-50">
    <div class="bg-white rounded-xl shadow-2xl p-6 sm:p-8 max-w-md w-full">
      <h3 class="text-2xl font-bold text-indigo-700 mb-4 text-center">🎉 새로운 기록 달성! 🎉</h3>
      <p class="text-slate-600 mb-6 text-center">점수: <span id="final-score" class="font-bold text-2xl text-indigo-600"></span></p>
      <div class="space-y-4">
        <div>
          <label for="nickname-input" class="block text-sm font-medium text-slate-700 mb-2">닉네임</label>
          <input type="text" id="nickname-input" placeholder="닉네임을 입력하세요" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
        </div>
        <div class="flex gap-3">
          <button id="save-score-btn" class="flex-1 bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors">저장</button>
          <button id="cancel-score-btn" class="flex-1 bg-slate-300 text-slate-700 font-bold py-3 px-6 rounded-lg hover:bg-slate-400 transition-colors">취소</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase SDK (모듈) -->
  <script type="module">
    /* ============================
       🔥 Firebase 초기화 (필수)
       ============================ */
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, doc, updateDoc, increment, serverTimestamp, onSnapshot, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";
    import {
      getAuth, signInAnonymously, onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";

    // TODO: 👉👉 여기 본인 Firebase 설정으로 교체하세요.
    // const firebaseConfig = {
    //   apiKey: "YOUR_API_KEY",
    //   authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    //   projectId: "YOUR_PROJECT_ID",
    //   storageBucket: "YOUR_PROJECT_ID.appspot.com",
    //   messagingSenderId: "YOUR_SENDER_ID",
    //   appId: "YOUR_APP_ID"
    // };

    const firebaseConfig = {
        apiKey: "AIzaSyDFJzNowl7cx_3I7B-oXnwAi6dd0Wj7P8Q",
        authDomain: "engcardgame-a3c01.firebaseapp.com",
        projectId: "engcardgame-a3c01",
        storageBucket: "engcardgame-a3c01.firebasestorage.app",
        messagingSenderId: "270499273972",
        appId: "1:270499273972:web:9be008423e7497db5152a1",
        measurementId: "G-61EWRYF11V"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    // (권장) 익명 로그인 사용 — 쓰기 규칙에서 auth != null 요구 시 필요
    
let __anonBackoffUntil = 0;
/**
 * ensureAuth({ allowAnonymous }): 
 *  - if user already signed in (google or anonymous) -> true
 *  - if not signed in:
 *      - allowAnonymous=true  -> try signInAnonymously with backoff
 *      - allowAnonymous=false -> do NOT auto sign-in (return false)
 */
async function ensureAuth(allowAnonymous = false) {
  try {
    if (auth.currentUser) return true;
  } catch (e) {
    return false;
  }
  if (!allowAnonymous) return false;
  const now = Date.now();
  if (now < __anonBackoffUntil) return false;
  try {
    await signInAnonymously(auth);
    return true;
  } catch (e) {
    // Backoff: 10m for rate limit, 1m otherwise
    __anonBackoffUntil = now + (e && e.code === "auth/too-many-requests" ? 10*60*1000 : 60*1000);
    console.warn("Anonymous sign-in suppressed:", e && e.code ? e.code : e);
    return false;
  }
}


    /* ============================
       🧠 기존 앱 코드 (간결화)
       ============================ */

    // --- 간단한 백엔드 래퍼: Firestore 우선, 실패 시 localStorage 폴백 ---
    const RankingsAPI = {
      async loadTop10() {
        try {
          /* no auth needed for read */ // 규칙에 따라 필요 없으면 삭제 가능
          const q = query(collection(db, "rankings"), orderBy("score", "desc"), limit(10));
          const snap = await getDocs(q);
          const list = [];
          snap.forEach(doc => {
            const d = doc.data();
            list.push({
              nickname: d.nickname || "",
              score: d.score || 0,
              date: d.date || new Date().toLocaleDateString()
            });
          });
          // Firestore 결과가 없으면 로컬 폴백
          if (!list.length) return RankingsAPI._loadFromLocal();
          // 정렬 보증
          return list.sort((a,b)=>b.score-a.score).slice(0,10);
        } catch (e) {
          console.warn("Firestore loadTop10 실패, localStorage로 폴백:", e);
          return RankingsAPI._loadFromLocal();
        }
      },
      async saveScore(nickname, score) {
        const payload = {
          nickname, score, date: new Date().toLocaleDateString()
        };
        try {
          await ensureAuth(true);
          await addDoc(collection(db, "rankings"), payload);
          return true;
        } catch (e) {
          console.warn("Firestore save 실패, localStorage로 폴백:", e);
          const ok = RankingsAPI._saveToLocal(payload);
          return ok;
        }
      },
      _loadFromLocal() {
        const raw = localStorage.getItem("kindredRankings");
        if (!raw) return [];
        try {
          const arr = JSON.parse(raw) || [];
          return arr.sort((a,b)=>b.score-a.score).slice(0,10);
        } catch (e) { return []; }
      },
      _saveToLocal(item) {
        try {
          const arr = RankingsAPI._loadFromLocal();
          arr.push(item);
          arr.sort((a,b)=>b.score-a.score);
          localStorage.setItem("kindredRankings", JSON.stringify(arr.slice(0,10)));
          return true;
        } catch (e) { return false; }
      }
    };

    // ========== 데이터(단어장) ==========
    const vocabData = {
            "Prologue": [
                { word: "persist", part: "v", pronunciation: "pərˈsɪst", meanings: { general: "(어려움에도 불구하고) 계속 ~하다, 고집하다, 지속하다. (파생어: persistence (n.) 끈기, persistent (adj.) 끈질긴)", novel: "노예제라는 비인간적인 힘에 맞서 자신의 정체성과 삶의 의지를 지키기 위한 정신적, 육체적 인내를 상징합니다.", example: "Despite the horrors she witnessed, Dana knew she had to persist.", translation: "그녀가 목격한 공포에도 불구하고, 데이나는 계속 버텨야만 한다는 것을 알았다." } },
                { word: "coherently", part: "adv", pronunciation: "koʊˈhɪrəntli", meanings: { general: "논리 정연하게, 시종일관되게. (파생어: coherent (adj.) 일관성 있는, coherence (n.) 일관성)", novel: "트라우마를 언어로 전달하는 것의 어려움을 강조합니다. 데이나는 자신의 경험을 논리 정연하게 설명하려 애쓰지만, 고통으로 인해 기억은 파편화되어 있습니다.", example: "Finally, I awoke feeling able to talk to him coherently.", translation: "마침내 나는 정신을 차리고 그에게 조리 있게 말할 수 있었다." } },
                { word: "might as well", part: "idiom", pronunciation: "", meanings: { general: "(더 나은 대안이 없으므로) ~하는 편이 낫다.", novel: "체념과 선택의 폭이 좁아진 상황을 강조합니다. 끔찍한 진실을 말하기보다 믿을 만한 거짓말을 하는 것이 낫다는 암울한 현실을 반영합니다.", example: "You convinced them that they might as well let me go.", translation: "당신은 그들에게 나를 그냥 보내주는 편이 낫겠다고 설득했지." } },
                { word: "toy (with)", part: "v", pronunciation: "tɔɪ", meanings: { general: "(생각을) 심각하지 않게 해보다, (물건을) 만지작거리다, (사람/감정을) 장난삼아 다루다.", novel: "조종과 불평등한 권력 관계를 암시합니다. 권력자들이 노예들의 삶과 감정을 '장난감처럼' 다룰 것을 불길하게 예고합니다.", example: "He toyed with my hand for a moment silently.", translation: "그는 잠시 말없이 내 손을 만지작거렸다." } }
            ],
            "The River": [
                { word: "loaf", part: "v", pronunciation: "loʊf", meanings: { general: "빈둥거리다, 하는 일 없이 어슬렁거리다. (파생어: loafer (n.) 게으름뱅이)", novel: "오직 백인 주인에게만 허락된 특권입니다. 노예에게 '빈둥거림'은 게으름의 증거이자 채찍질의 이유가 됩니다.", example: "Kevin had stopped when he got his office in order. Now he was closeted there either loafing or thinking.", translation: "케빈은 자기 사무실을 정리한 뒤 멈췄다. 이제 그는 그곳에 틀어박혀 빈둥거리거나 생각에 잠겨 있었다." } },
                { word: "perversity", part: "n", pronunciation: "pərˈvɜːrsəti", meanings: { general: "괴팍함, 심술궂음, 비뚤어짐. (파생어: perverse (adj.) 비뚤어진)", novel: "노예제 사회의 비정상적이고 뒤틀린 논리를 압축적으로 보여줍니다. 선한 행동이 위협으로 받아들여지는 상황 자체가 '비뚤어짐'의 극치입니다.", example: "Just struggling with my own perversity.", translation: "나 자신의 심술궂음과 씨름하고 있을 뿐." } },
                { word: "malevolent", part: "adj", pronunciation: "məˈlevələnt", meanings: { general: "악의 있는, 악의적인. (파생어: malevolence (n.) 악의)", novel: "앞으로 데이나가 마주할 진짜 악의, 즉 노예 소유주들의 체계적이고 의도적인 잔인함과 대조를 이룹니다.", example: "He gave me a look that I knew wasn't as malevolent as it seemed.", translation: "그는 내가 보기에도 그리 악의적으로 보이지 않는 표정을 지었다." } },
                { word: "wade", part: "v", pronunciation: "weɪd", meanings: { general: "(물이나 진흙 속을) 헤치며 걷다.", novel: "자신의 의지와 상관없이 위험하고 낯선 과거의 역사 속으로 직접 발을 들여놓는 것을 상징합니다.", example: "I ran down to the river, waded into the water fully clothed, and swam quickly to the child.", translation: "나는 강으로 달려가 옷을 입은 채 물속을 헤치며 아이에게 재빨리 헤엄쳐 갔다." } },
                { word: "resuscitation", part: "n", pronunciation: "rɪˌsʌsɪˈteɪʃn", meanings: { general: "소생, 부활; (특히) 인공호흡. (파생어: resuscitate (v.) 소생시키다)", novel: "현대 의학 지식을 이용한 생명 구조 행위입니다. 그녀가 과거 시대에 속하지 않은 외부인임을 명확히 보여주는 첫 사건입니다.", example: "I put him down on his back, tilted his head back, and began mouth-to-mouth resuscitation.", translation: "나는 그를 눕히고 머리를 뒤로 젖힌 다음, 입을 맞대고 인공호흡을 시작했다." } },
                { word: "smother", part: "v", pronunciation: "ˈsmʌðər", meanings: { general: "질식시키다, (감정 등을) 억누르다.", novel: "물리적, 정신적 억압을 동시에 의미합니다. 노예제는 개인의 자유와 감정을 '질식시키는' 체제입니다.", example: "She grabbed him and nearly smothered him.", translation: "그녀는 그를 붙잡고 거의 질식시킬 뻔했다." } },
                { word: "inflict on", part: "v", pronunciation: "ɪnˈflɪkt ɒn", meanings: { general: "(고통·피해 등을) 가하다, 안기다. (파생어: infliction (n.) 고통을 가함)", novel: "노예제 하에서 자행되는 폭력의 일방성과 부당함을 명확히 보여줍니다. 고통은 노예들에게 '가해지는' 것입니다.", example: "Ugly name to inflict on a reasonably nice-looking little kid.", translation: "꽤 잘생긴 어린 아이에게 붙이기에는 끔찍한 이름이다." } },
                { word: "tentatively", part: "adv", pronunciation: "ˈtentətɪvli", meanings: { general: "잠정적으로, 머뭇거리며, 시험적으로. (파생어: tentative (adj.) 잠정적인)", novel: "데이나의 모든 행동은 '머뭇거리며' 이루어질 수밖에 없습니다. 과거 시대의 규칙을 모르기 때문입니다.", example: "He came over to me, touched me tentatively as though he wasn't sure I was real.", translation: "그는 내게 다가와, 내가 진짜인지 확신이 서지 않는 듯 조심스럽게 나를 만졌다." } },
                { word: "humor", part: "v", pronunciation: "ˈhjuːmər", meanings: { general: "비위를 맞추다, 기분을 맞춰주다.", novel: "힘의 불균형 속에서 약자가 강자의 비위를 맞추며 자신을 지켜야 하는 상황을 예고합니다.", example: "Hell, I don't blame you for humoring me.", translation: "젠장, 내 비위를 맞춰주는 걸 탓하지는 않아." } },
                { word: "recede", part: "v", pronunciation: "rɪˈsiːd", meanings: { general: "물러나다, 멀어지다, 약해지다. (파생어: recession (n.) 후퇴)", novel: "끔찍한 과거의 경험이 현재로 돌아오면 기억 속에서 희미해지는 트라우마의 속성을 보여줍니다.", example: "it's beginning to recede from me somehow.", translation: "어쩐지 내게서 점점 멀어지고 있는 것 같아." } }
            ],
            "The Fire": [
                { word: "limbo", part: "n", pronunciation: "ˈlɪmboʊ", meanings: { general: "어중간한 상태, 망각의 상태.", novel: "데이나가 처한 실존적 상태를 묘사합니다. 과거에도 현재에도 온전히 속하지 못하고 두 세계 사이에 갇혀 있습니다.", example: "They made their own limbo and held me in it.", translation: "그들은 자신들만의 어중간한 상태를 만들어 나를 그 안에 가두었다." } },
                { word: "abbreviated", part: "adj", pronunciation: "əˈbriːvieɪtɪd", meanings: { general: "축약된, 단축된. (파생어: abbreviate (v.) 줄여쓰다, abbreviation (n.) 축약)", novel: "노예들의 삶은 기본적인 인간 권리가 '축약된' 상태임을 암시합니다.", example: "I found myself sitting on a small bed sheltered by a kind of abbreviated dark green canopy.", translation: "나는 일종의 축소된 짙은 녹색 덮개로 가려진 작은 침대에 앉아 있었다." } },
                { word: "canopy", part: "n", pronunciation: "ˈkænəpi", meanings: { general: "(침대 등의) 덮개, 차양.", novel: "웨일린 가문의 부유함과 그 이면의 폭력이라는 모순을 상징합니다.", example: "Rufus stood beside the ornate canopy bed, watching the curtains burn.", translation: "루퍼스는 화려한 캐노피 침대 옆에 서서, 불타는 커튼을 바라보고 있었다." } },
                { word: "avert", part: "v", pronunciation: "əˈvɜːrt", meanings: { general: "(눈·얼굴 등을) 돌리다, 피하다. (파생어: aversion (n.) 혐오)", novel: "끔찍한 현실을 마주해야 하는 개인의 내적 갈등을 보여줍니다.", example: "My hasty act had done no harm. I could go home knowing that I had averted trouble for the second time.", translation: "나의 성급한 행동은 해를 끼치지 않았다. 나는 두 번째로 재앙을 피했다는 것을 알며 집으로 갈 수 있었다." } },
                { word: "deflate", part: "v", pronunciation: "dɪˈfleɪt", meanings: { general: "공기를 빼다, (희망을) 꺾다. (파생어: deflation (n.) 수축)", novel: "노예제도가 인간의 희망과 자존심을 체계적으로 꺾는 시스템임을 의미합니다.", example: "The boy seemed to deflate. His shoulders sagged and he turned to stare into the fireplace.", translation: "소년은 기가 죽은 듯 보였다. 그의 어깨는 축 처졌고 그는 벽난로를 응시했다." } },
                { word: "crisscross", part: "v", pronunciation: "ˈkrɪskrɔːs", meanings: { general: "종횡으로 교차하다.", novel: "등에 난 채찍 자국처럼 반복적인 폭력을 시각적으로 보여줍니다.", example: "He turned and pulled up his shirt so that I could see the crisscross of long red welts.", translation: "그는 돌아서서 셔츠를 걷어 올려 길고 붉은 매 자국들이 교차하는 것을 내게 보여주었다." } },
                { word: "welt", part: "n", pronunciation: "welt", meanings: { general: "(채찍 등으로 맞아서) 부어 오른 자국, 매 자국.", novel: "노예제도의 폭력성을 가장 직접적으로 보여주는 단어입니다. 인간의 몸에 새겨진 억압과 고통의 증거입니다.", example: "He lifted his shirt to show the awful welts on his back.", translation: "그는 셔츠를 들어 올려 등에 난 끔찍한 매 자국을 보여주었다." } },
                { word: "warily", part: "adv", pronunciation: "ˈwerəli", meanings: { general: "조심스럽게, 경계하며. (파생어: wary (adj.) 조심하는)", novel: "불신과 공포가 만연한 농장에서 살아남기 위한 생존 방식입니다.", example: "He looked at me warily.", translation: "그는 나를 조심스럽게 쳐다보았다." } },
                { word: "ornately", part: "adv", pronunciation: "ɔːrˈneɪtli", meanings: { general: "화려하게, 화려하게 장식하여. (파생어: ornate (adj.) 화려한)", novel: "화려함 이면에 숨겨진 착취와 폭력의 현실을 병치시킵니다.", example: "a large Bible in an ornately carved, wooden chest", translation: "화려하게 조각된 나무 상자 안의 커다란 성경" } },
                { word: "ante bellum", part: "adj", pronunciation: "ˌænti ˈbeləm", meanings: { general: "전쟁 전의, (특히) 미국 남북전쟁 전의.", novel: "단순한 시대 구분이 아니라, 데이나가 맞서 싸워야 하는 거대한 사회 시스템 전체를 지칭합니다.", example: "A name for whites who rode through the night in the ante bellum South...", translation: "남북전쟁 이전의 남부에서 밤새 말을 타고 달리던 백인들을 부르는 이름..." } },
                { word: "descend", part: "v", pronunciation: "dɪˈsend", meanings: { general: "내려오다, (자손에게) 전해지다. (파생어: descendant (n.) 후손)", novel: "혈연과 유산, 그리고 세습되는 폭력과 신분을 의미합니다.", example: "Dana was shocked to realize she was descended from Rufus and Alice.", translation: "데이나는 자신이 루퍼스와 앨리스의 후손이라는 사실을 깨닫고 충격에 빠졌다." } },
                { word: "incidentally", part: "adv", pronunciation: "ˌɪnsɪˈdentəli", meanings: { general: "부수적으로, 우연히. (파생어: incident (n.) 사건)", novel: "우연처럼 보이는 사건들 속에 숨겨진 필연적인 인과관계를 암시합니다.", example: "And, incidentally, he was playing with fire again, helping an intruder to escape.", translation: "그리고 우연히도, 그는 침입자가 탈출하는 것을 도우며 다시 불장난을 하고 있었다." } },
                { word: "drapery", part: "n", pronunciation: "ˈdreɪpəri", meanings: { general: "휘장, 커튼류. (파생어: drape (v.) 덮다)", novel: "평범한 가정 용품이 위험의 시발점이 될 수 있음을 상징합니다.", example: "I could have safely thrown the draperies into it and let them burn.", translation: "나는 안전하게 커튼을 그 안에 던져 태울 수도 있었다." } },
                { word: "skirt around", part: "v", pronunciation: "skɜːrt əˈraʊnd", meanings: { general: "(문제 등을) 회피하다.", novel: "불편한 진실을 마주하기를 거부하는 인간의 나약함을 보여줍니다.", example: "I skirted around a field of some grassy waist-high crop.", translation: "나는 허리 높이의 풀이 무성한 밭을 둘러 갔다." } },
                { word: "hug", part: "v", pronunciation: "hʌɡ", meanings: { general: "껴안다, 바싹 붙어 가다.", novel: "인간적인 온기와 공포 속에서의 은신이라는 대조적인 의미를 가집니다.", example: "I hugged the side of the road, trying to suppress my nervousness.", translation: "나는 초조함을 억누르려 애쓰며 길가에 바싹 붙어 갔다." } },
                { word: "transferal", part: "n", pronunciation: "trænsˈfɜːrəl", meanings: { general: "이전, 양도. (파생어: transfer (v.) 이전하다)", novel: "인간이 물건처럼 거래되는 노예 제도의 비인간성을 드러냅니다.", example: "I collapsed to my knees, desperately willing the dizziness to intensify, the transferal to come.", translation: "나는 무릎을 꿇고 쓰러져, 현기증이 심해지기를, 시간 이동이 오기를 간절히 바랐다." } },
                { word: "splintering", part: "v", pronunciation: "ˈsplɪntərɪŋ", meanings: { general: "쪼개지다, 산산조각 나다. (파생어: splinter (n.) 파편)", novel: "물리적 파괴와 정신적 붕괴를 동시에 묘사합니다.", example: "There was a sound of splintering wood, and the door swung inward.", translation: "나무가 쪼개지는 소리가 나더니 문이 안으로 활짝 열렸다." } },
                { word: "scramble away", part: "v", pronunciation: "ˈskræmbəl əˈweɪ", meanings: { general: "허둥지둥 달아나다.", novel: "폭력 앞에서 생존을 위해 본능적으로 도망치는 약자의 절박함을 보여줍니다.", example: "She was allowed to fall to the ground and scramble away, ignored by the men.", translation: "그녀는 땅에 넘어져 허둥지둥 달아나도록 내버려졌고, 남자들은 그녀를 무시했다." } },
                { word: "hustle", part: "v", pronunciation: "ˈhʌsəl", meanings: { general: "서두르다, 거칠게 밀치다.", novel: "외부의 압력과 폭력에 의해 강제되는 노예들의 노동을 보여줍니다.", example: "They hustled the man to a tree so close to me that I lay flat on the ground.", translation: "그들은 그 남자를 내게 너무 가까운 나무로 거칠게 밀치고 가서 나는 땅에 납작 엎드렸다." } },
                { word: "raucous", part: "adj", pronunciation: "ˈrɔːkəs", meanings: { general: "(소리가) 거슬리는, 시끄러운.", novel: "주로 백인 순찰대원들의 난폭하고 위협적인 소음을 묘사하여 공포 분위기를 조성합니다.", example: "There was raucous laughter.", translation: "거슬리는 웃음소리가 있었다." } },
                { word: "obscenity", part: "n", pronunciation: "əbˈsenəti", meanings: { general: "외설, 음란한 말(행동). (파생어: obscene (adj.) 외설적인)", novel: "인간 존엄성에 대한 끔찍한 모독인 노예제도 그 자체가 하나의 거대한 '외설'임을 의미합니다.", example: "There were obscenities, more laughter.", translation: "음담패설과 더 많은 웃음소리가 있었다." } },
                { word: "convulse", part: "v", pronunciation: "kənˈvʌls", meanings: { general: "경련을 일으키게 하다, 온몸을 뒤흔들다. (파생어: convulsion (n.) 경련)", novel: "극심한 고통이나 공포로 몸이 통제 불능 상태에 빠지는 것을 묘사합니다. 트라우마의 신체적 영향입니다.", example: "The man's body convulsed, but the only sound he made was a gasp.", translation: "남자의 몸은 경련했지만, 그가 낸 유일한 소리는 숨 막히는 소리뿐이었다." } },
                { word: "resolve", part: "n", pronunciation: "rɪˈzɒlv", meanings: { general: "결심, 결의, 확고부동함. (파생어: resolute (adj.) 단호한)", novel: "생존과 저항의 핵심 요소입니다. 거대한 억압에 맞서 개인의 결의를 유지하기 위한 힘겨운 싸움을 그립니다.", example: "Then the man's resolve broke.", translation: "그때 그 남자의 결의가 무너졌다." } },
                { word: "heave", part: "v", pronunciation: "hiːv", meanings: { general: "(무거운 것을) 들다, (가슴이) 들썩이다.", novel: "격렬한 감정 상태를 신체적으로 표현합니다.", example: "My stomach heaved, and I had to force myself to stay where I was and keep quiet.", translation: "속이 울렁거렸고, 나는 억지로 그 자리에 머물며 조용히 있어야 했다." } },
                { word: "ostensibly", part: "adv", pronunciation: "ɒˈstensəbli", meanings: { general: "표면상으로는, 겉보기에는. (파생어: ostensible (adj.) 표면상의)", novel: "노예제 사회의 위선적인 명분과 그 이면에 숨겨진 잔혹한 진실 사이의 간극을 드러냅니다.", example: "Groups of young whites who ostensibly maintained order among the slaves.", translation: "표면상으로는 노예들 사이의 질서를 유지하는 젊은 백인들의 집단." } },
                { word: "slanting off", part: "idiom", pronunciation: "", meanings: { general: "비스듬히 빗나가다, 벗어나다.", novel: "불편한 진실을 회피하려는 시도를 의미합니다.", example: "The patrol and its stumbling captive headed back to the road, slanting off toward the Weylin house.", translation: "순찰대와 비틀거리는 포로는 웨일린 집을 향해 비스듬히 길을 벗어나 돌아갔다." } },
                { word: "grim", part: "adj", pronunciation: "ɡrɪm", meanings: { general: "엄숙한, 암울한, 비장한. (파생어: grimly (adv.) 엄하게)", novel: "노예제의 암울하고 절망적인 현실 그 자체를 묘사합니다.", example: "She looked tall and straight and grim and years older.", translation: "그녀는 키가 크고 곧았으며, 엄숙하고 나이 들어 보였다." } },
                { word: "look contrite", part: "idiom", pronunciation: "", meanings: { general: "죄를 뉘우치는 듯 보이다. (파생어: contrition (n.) 뉘우침)", novel: "생존을 위해 억지로 복종하는 척하는 노예들의 심리 상태를 반영합니다.", example: "She looked contrite. 'You must be hungry now.'", translation: "그녀는 뉘우치는 표정을 지었다. '지금 배고프시겠군요.'" } },
                { word: "wrench away", part: "v", pronunciation: "rentʃ əˈweɪ", meanings: { general: "비틀어 떼어내다, 뿌리치다.", novel: "폭력적인 상황에서 벗어나려는 필사적인 저항의 몸짓입니다.", example: "Surprise and pain made the man loosen his grip on me slightly, and I wrenched away.", translation: "놀람과 고통에 남자가 나를 잡은 손을 살짝 놓았고, 나는 뿌리쳤다." } },
                { word: "bar one's way", part: "idiom", pronunciation: "", meanings: { general: "~의 길을 막다.", novel: "물리적, 사회적으로 노예들의 자유를 막는 모든 장벽을 상징합니다.", example: "I ran mindlessly toward the cabin door only to find Alice's mother there barring my way.", translation: "나는 무작정 오두막 문으로 달려갔지만, 앨리스의 어머니가 길을 막고 서 있는 것을 발견했다." } },
                { word: "gouge", part: "v", pronunciation: "ɡaʊdʒ", meanings: { general: "(눈 등을) 파내다, 도려내다.", novel: "생존을 위한 가장 극단적이고 잔인한 저항의 형태입니다.", example: "I had only to move my fingers a little and jab them into the soft tissues, gouge away his sight.", translation: "나는 손가락을 조금만 움직여 부드러운 조직을 찌르고, 그의 시야를 파내기만 하면 되었다." } },
                { word: "squeamishness", part: "n", pronunciation: "ˈskwiːmɪʃnəs", meanings: { general: "비위가 약함, 결벽증. (파생어: squeamish (adj.) 비위가 약한)", novel: "현대인의 도덕적 감수성이 과거의 잔혹함 앞에서 얼마나 무력한지를 보여줍니다.", example: "My squeamishness belonged in another age, but I'd brought it along with me.", translation: "나의 비위 약함은 다른 시대의 것이었지만, 나는 그것을 가지고 왔다." } },
                { word: "rear", part: "v", pronunciation: "rɪr", meanings: { general: "(말 등이) 뒷다리로 일어서다, (머리를) 치켜들다.", novel: "폭력 앞에서 분노하거나 저항하는 순간적인 움직임을 묘사합니다.", example: "Then suddenly, for no reason that I could see, he reared above me, fist drawn back to hit me again.", translation: "그때 갑자기, 내가 알 수 없는 이유로, 그는 내 위로 솟아올라 다시 나를 때리려고 주먹을 뒤로 뺐다." } },
                { word: "tree limb", part: "n", pronunciation: "triː lɪm", meanings: { general: "나뭇가지.", novel: "우연히 손에 쥔 저항의 도구. 생존을 위한 즉흥적인 무기입니다.", example: "the thing I had hit my head on was a heavy stick—a tree limb, perhaps.", translation: "내 머리를 부딪친 것은 무거운 막대기, 아마도 나뭇가지였을 것이다." } },
                { word: "will", part: "v", pronunciation: "wɪl", meanings: { general: "~하기를 바라다, 의지로 ~하게 하다.", novel: "생존에 대한 강렬한 의지. 정신력으로 육체의 한계를 극복하려는 노력입니다.", example: "I caught hold of a tree and willed myself to stay conscious.", translation: "나는 나무를 붙잡고 의식을 잃지 않으려고 애썼다." } },
                { word: "lunge up", part: "v", pronunciation: "lʌndʒ ʌp", meanings: { general: "위로 돌진하다, 튀어 오르다.", novel: "공격이나 방어를 위해 폭발적으로 몸을 움직이는 것을 묘사합니다.", example: "I could do anything. I lunged up toward his eyes.", translation: "나는 무엇이든 할 수 있었다. 나는 그의 눈을 향해 돌진했다." } },
                { word: "weave in", part: "v", pronunciation: "wiːv ɪn", meanings: { general: "(이야기 등을) 엮어 넣다.", novel: "데이나가 자신의 경험과 역사적 사실을 엮어 하나의 이야기로 만드는 과정을 상징합니다.", example: "That I was hallucinating and weaving in the names of my ancestors?", translation: "내가 환각을 보고 조상들의 이름을 엮어 넣고 있었다는 건가?" } },
                { word: "groggily", part: "adv", pronunciation: "ˈɡrɒɡɪli", meanings: { general: "(몸을 가누지 못하고) 비틀거리며, 그로기 상태로. (파생어: groggy (adj.) 비틀거리는)", novel: "육체적, 정신적 충격으로 인해 혼미한 상태를 묘사합니다.", example: "I rubbed my face groggily, and in a sudden slashing motion, drew the ruler across his abdomen.", translation: "나는 정신없이 얼굴을 문지르고, 갑작스럽게 베는 동작으로 그의 복부를 가로질러 자를 그었다." } },
                { word: "a road atlas", part: "n", pronunciation: "ə roʊd ˈætləs", meanings: { general: "도로 지도책.", novel: "자유로 향하는 길을 찾으려는 희망과 그 길의 험난함을 동시에 상징합니다.", example: "I wish I had a road atlas for you.", translation: "너를 위한 도로 지도책이 있었으면 좋겠어." } },
                { word: "be liable to", part: "idiom", pronunciation: "", meanings: { general: "~하기 쉽다, ~할 것 같다. (파생어: liability (n.) 책임)", novel: "언제든 닥칠 수 있는 위험과 죽음의 가능성을 암시합니다.", example: "If you run, you're likely to be shot.", translation: "만약 달아나면, 총에 맞기 쉽다." } }
            ],
            "The Fall": [
                { word: "be out of place", part: "idiom", pronunciation: "", meanings: { general: "제자리에 있지 않다, 어울리지 않다.", novel: "데이나와 케빈이 과거 시대에 완전히 어울리지 않는 존재임을 나타냅니다.", example: "I think Kevin was as lonely and didn't fit in as I was when I met him.", translation: "케빈과 나는 우리가 만났을 때 나만큼이나 외롭고 어울리지 못하는 사람이었다고 생각한다." } },
                { word: "wino", part: "n", pronunciation: "ˈwaɪnoʊ", meanings: { general: "알코올 중독자 (특히 값싼 포도주를 마시는).", novel: "현대 사회의 소외된 계층. 노예제 사회의 'nonpeople'과 비교되며, 시대와 상관없이 존재하는 인간 소외를 보여줍니다.", example: "Waiting with you were alcoholics trying to work themselves into a few more bottles.", translation: "당신과 함께 기다리는 사람들 중에는 술 몇 병 더 마시려고 일하는 알코올 중독자들이 있었다." } },
                { word: "dispatcher", part: "n", pronunciation: "dɪˈspætʃər", meanings: { general: "배차원, 발송 담당자. (파생어: dispatch (v.) 파견하다)", novel: "노동력을 통제하고 분배하는 인물. 노예 시장의 감독관이나 경매인과 유사한 역할을 합니다.", example: "You sat and sat until the coordinator either sent you out on a job or sent you home.", translation: "당신은 배차원이 일자리를 주거나 집으로 보낼 때까지 앉아서 기다렸다." } },
                { word: "nonpeople", part: "n", pronunciation: "ˈnɒnpiːpəl", meanings: { general: "인간 취급을 받지 못하는 사람들.", novel: "노예제 사회에서 흑인들이 처한 상황을 정확히 묘사합니다. 그들은 인격체가 아닌 재산으로 취급받았습니다.", example: "it was done by mindless people. Individuals not considered human rented for a few hours.", translation: "그것은 생각 없는 사람들에 의해 행해졌다. 몇 시간 동안 빌려 쓰는 인간 이하의 존재들." } },
                { word: "trance", part: "n", pronunciation: "træns", meanings: { general: "무아지경, 혼수상태.", novel: "고된 노동과 절망 속에서 정신적으로 현실을 도피하는 상태를 의미합니다.", example: "Wine put him into some kind of daze, though, and he just sat and stared.", translation: "하지만 와인은 그를 일종의 무아지경에 빠뜨렸고, 그는 그저 앉아서 멍하니 쳐다보기만 했다." } },
                { word: "sidle by", part: "v", pronunciation: "ˈsaɪdəl baɪ", meanings: { general: "슬그머니 옆으로 다가가다/지나가다.", novel: "주목받지 않고 위험을 피하려는 노예들의 조심스러운 행동 방식입니다.", example: "Buz moved past cautiously. 'Hey,' he said, low-voiced. 'Porn!'", translation: "버즈가 슬그머니 다가왔다. '이봐,' 그가 낮은 목소리로 말했다. '포르노!'" } },
                { word: "exasperation", part: "n", pronunciation: "ɪɡˌzæspəˈreɪʃn", meanings: { general: "격분, 분노. (파생어: exasperate (v.) 격분시키다)", novel: "억압적인 상황에 대한 분노와 좌절감. 데이나가 자주 느끼는 감정입니다.", example: "I closed my eyes in frustration.", translation: "나는 분노에 차 눈을 감았다." } },
                { word: "tactlessly", part: "adv", pronunciation: "ˈtæktləsli", meanings: { general: "재치 없게, 눈치 없이. (파생어: tactless (adj.) 재치 없는)", novel: "권력자들이 약자들의 감정을 고려하지 않고 무심코 내뱉는 말과 행동입니다.", example: "'You look older,' he said without thinking.", translation: "'너 늙어 보여,' 그가 눈치 없이 말했다." } },
                { word: "mutter", part: "v", pronunciation: "ˈmʌtər", meanings: { general: "중얼거리다, 투덜거리다.", novel: "직접적으로 불만을 표출할 수 없는 노예들이 소극적으로 저항하는 방식입니다.", example: "'So do you,' I said under my breath.", translation: "'너도 그래,' 나는 중얼거렸다." } },
                { word: "demote", part: "v", pronunciation: "diːˈmoʊt", meanings: { general: "강등시키다. (파생어: demotion (n.) 강등)", novel: "데이나가 생존을 위해 자신의 지위(케빈의 아내)를 노예로 '강등'시켜야 하는 상황입니다.", example: "Kevin, I think we'd better lower my status. In this time...", translation: "케빈, 내 생각엔 나를 강등시키는 게 낫겠어. 이 시대에서는..." } },
                { word: "bicentennial quarter", part: "n", pronunciation: "ˌbaɪsenˈteniəl ˈkwɔːrtər", meanings: { general: "미국 독립 200주년 기념 25센트 동전.", novel: "데이나가 미래에서 왔다는 명백한 증거. 과거와 현재의 엄청난 시간적 간극을 상징합니다.", example: "He picked out a commemorative coin and handed it to Rufus.", translation: "그는 200주년 기념 쿼터 동전을 골라 루퍼스에게 건넸다." } },
                { word: "depraved", part: "adj", pronunciation: "dɪˈpreɪvd", meanings: { general: "타락한, 부패한. (파생어: depravity (n.) 타락)", novel: "노예 소유주들의 도덕적 타락과 비인간적인 행위를 묘사합니다.", example: "Weylin didn't look especially vicious or corrupt.", translation: "웨일린은 특별히 사악하거나 타락해 보이지 않았다." } },
                { word: "splint", part: "n", pronunciation: "splɪnt", meanings: { general: "부목.", novel: "원시적인 의료 환경을 상징합니다. 현대 의학의 부재를 보여줍니다.", example: "Kevin and I should have made a support for that leg, I thought belatedly.", translation: "케빈과 나는 그 다리에 부목을 대주었어야 했다고 뒤늦게 생각했다." } },
                { word: "belatedly", part: "adv", pronunciation: "bɪˈleɪtɪdli", meanings: { general: "뒤늦게. (파생어: belated (adj.) 뒤늦은)", novel: "위험한 상황이 지난 후에야 올바른 판단을 하게 되는 데이나의 경험입니다.", example: "I thought about it later than I should have.", translation: "나는 뒤늦게 생각했다." } },
                { word: "exasperate", part: "v", pronunciation: "ɪɡˈzæspəreɪt", meanings: { general: "몹시 화나게 하다.", novel: "데이나가 겪는 불합리한 상황들이 그녀를 격분시키는 것을 표현합니다.", example: "Weylin looked very annoyed.", translation: "웨일린은 화가 난 듯 보였다." } },
                { word: "perennial", part: "adj", pronunciation: "pəˈreniəl", meanings: { general: "지속적인, 영원한.", novel: "노예제 사회에서 여성이 '영원한 아이'로 취급받는 가부장적 인식을 비판합니다.", example: "a society that considered women everlasting children.", translation: "여성을 영원한 아이로 여기는 사회." } },
                { word: "ingest", part: "v", pronunciation: "ɪnˈdʒest", meanings: { general: "(음식·약 등을) 섭취하다. (파생어: ingestion (n.) 섭취)", novel: "과거 시대의 비위생적인 음식과 질병의 위험을 암시합니다.", example: "people casually, unknowingly ate all kinds of poorly preserved ill-cooked food.", translation: "사람들은 무심코, 무지하게 온갖 종류의 제대로 보존되지 않고 덜 익은 음식을 섭취했다." } },
                { word: "acclimatize", part: "v", pronunciation: "əˈklaɪmətaɪz", meanings: { general: "(새로운 환경에) 적응하다. (파생어: acclimatization (n.) 적응)", novel: "데이나가 과거 시대의 폭력과 비인간성에 점차 무뎌지고 적응해가는 과정입니다. 생존을 위한 필수 과정이자 정체성을 잃을 수 있는 위험입니다.", example: "How easily we seemed to adapt.", translation: "우리가 얼마나 쉽게 적응하는 것처럼 보였는지." } },
                { word: "wench", part: "n", pronunciation: "wentʃ", meanings: { general: "(구식, 경멸적) 젊은 여성, 계집.", novel: "흑인 여성을 성적 대상으로 비하하고 물건처럼 취급하는 노예 소유주들의 시각을 드러냅니다.", example: "Now here a likely young woman, called the boy on the stump.", translation: "자, 여기 쓸만한 계집이 있소, 라고 나무 그루터기 위의 소년이 외쳤다." } },
                { word: "dab", part: "v", pronunciation: "dæb", meanings: { general: "가볍게 두드리다, 톡톡 바르다.", novel: "상처를 치료하거나 눈물을 닦는 등, 고통 속에서 나타나는 섬세하고 조심스러운 행동입니다.", example: "Margaret got up and lightly touched her eyes.", translation: "마거릿은 일어나 눈가를 톡톡 닦았다." } },
                { word: "caress", part: "v", pronunciation: "kəˈres", meanings: { general: "어루만지다, 애무하다.", novel: "애정과 소유욕, 위선이 뒤섞인 복잡한 감정 표현입니다. 루퍼스가 앨리스에게 보이는 행동입니다.", example: "Carrie's fingers gently touched one of the drawings for a moment.", translation: "캐리의 손가락이 잠시 그림 중 하나를 어루만졌다." } },
                { word: "be in for", part: "idiom", pronunciation: "", meanings: { general: "(불쾌한 일을) 당하게 되다.", novel: "앞으로 닥칠 고난과 위험을 예고합니다.", example: "if the people inside this cabin were black, they were almost certainly going to face trouble.", translation: "만약 이 오두막 안의 사람들이 흑인이라면, 그들은 거의 확실히 곤경에 처하게 될 것이다." } },
                { word: "squarely", part: "adv", pronunciation: "ˈskwerli", meanings: { general: "정면으로, 똑바로.", novel: "피할 수 없는 현실이나 진실을 직시해야 하는 상황을 나타냅니다.", example: "He turned to face me directly.", translation: "그는 나를 정면으로 마주보기 위해 돌아섰다." } },
                { word: "sear", part: "v", pronunciation: "sɪr", meanings: { general: "그슬리다, 낙인을 찍다.", novel: "채찍질이 남기는 끔찍한 고통과 지워지지 않는 상처를 생생하게 묘사합니다.", example: "But it came—like a hot iron across my back, burning into me through my light shirt, scorching my skin.", translation: "그러나 그것은 왔다—뜨거운 쇠가 등을 가로지르는 것처럼, 내 얇은 셔츠를 뚫고 살을 태우며, 내 피부를 그슬렸다." } }
            ],
             "The Fight": [
        {"word":"crowd out","part":"phrasal v","pronunciation":"kraʊd aʊt","meanings":{"general":"~을 몰아내다, ~가 설 자리가 없게 만들다.","novel":"데이나와 케빈의 삶에서 책이 차지하는 중요성을 보여줍니다. 가구를 '몰아낼' 정도로 많은 책들은 그들이 현실보다 지적인 세계에 더 안주하고 있음을 암시하며, 이는 나중에 잔혹한 과거의 현실과 충돌하게 됩니다.","example":"We both had books shelved and stacked and boxed and crowding out the furniture.","translation":"우리 둘 다 책장에, 쌓아두고, 상자에 넣어둔 책들이 가구를 비좁게 만들고 있었다."}},
        {"word":"homely","part":"adj","pronunciation":"ˈhoʊmli","meanings":{"general":"못생긴, 매력 없는. (파생어: homeliness (n.) 못생김)","novel":"외모에 대한 사회적 압박과 그로 인한 소외를 보여줍니다. 케빈의 누나가 흑인 친구와 함께 '못생겼다'는 이유로 어울렸다는 이야기는, 인종을 넘어 외모라는 또 다른 잣대가 어떻게 여성들을 판단하고 고립시키는지를 드러냅니다.","example":"The other girl was black and fat and homely, and Carol was white and fat and homely.","translation":"다른 소녀는 흑인이고 뚱뚱하고 못생겼으며, 캐럴은 백인이고 뚱뚱하고 못생겼다."}},
        {"word":"smug","part":"adj","pronunciation":"smʌɡ","meanings":{"general":"의기양양한, 우쭐해 하는. (파생어: smugly (adv.) 우쭐대며, smugness (n.) 잘난 체함)","novel":"기득권층의 자기만족적이고 편협한 태도를 비판합니다. 케빈의 매형이 '우쭐해 하는' 인물로 묘사되는 것은, 그의 인종차별적 태도가 확고한 신념보다는 사회적 지위에서 오는 오만함에 기반하고 있음을 암시합니다.","example":"She wound up marrying the first dentist she ever worked for—a smug little reactionary twenty years older than she was.","translation":"그녀는 결국 자신이 처음으로 일했던 치과의사와 결혼했는데, 그는 그녀보다 스무 살이나 많은 의기양양한 작은 반동분자였다."}},
        {"word":"bigotry","part":"n","pronunciation":"ˈbɪɡətri","meanings":{"general":"편견, 편협. (파생어: bigot (n.) 편견이 아주 심한 사람, bigoted (adj.) 편견을 가진)","novel":"사회에 만연한 인종차별이 어떻게 개인의 사고방식을 형성하는지를 보여줍니다. 케빈의 누나가 남편의 '편협한' 가치관을 그대로 따라 하는 모습은, 증오와 편견이 개인적인 관계를 통해 어떻게 전파되고 재생산되는지를 드러냅니다.","example":"Now she lives in a big house in La Canada and quotes clichéd bigotry at me for wanting to marry you.","translation":"이제 그녀는 라 카냐다의 큰 집에 살면서, 내가 너와 결혼하고 싶어 한다는 이유로 내게 진부한 편견을 인용한다."}},
        {"word":"reactionary","part":"n","pronunciation":"riˈækʃəneri","meanings":{"general":"반동분자, 보수 반동적인 사람. (파생어: reaction (n.) 반작용, 반응)","novel":"사회 변화에 저항하고 과거의 억압적인 질서를 유지하려는 인물을 지칭합니다. 케빈의 매형을 '반동분자'로 묘사하는 것은, 그의 인종차별적 태도가 단순히 개인적인 편견을 넘어, 사회 진보를 거부하는 퇴행적인 이데올로기임을 강조합니다.","example":"Sounds like the reactionary moved to the right town.","translation":"그 반동주의자가 제대로 된 동네로 이사 간 것 같군."}},
        {"word":"pare down","part":"phrasal v","pronunciation":"per daʊn","meanings":{"general":"줄이다, 삭감하다.","novel":"고통스럽고 복잡한 가족의 반응을 전달하는 것의 어려움을 나타냅니다. 데이나가 친척들의 말을 '줄여서' 전달하는 것은, 인종 간 결혼에 대한 뿌리 깊은 편견과 상처를 직접적으로 마주하는 감정적 부담을 보여줍니다.","example":"I looked at my hands, thinking about all they had said, paring it down wearily.","translation":"나는 손을 내려다보며 그들이 했던 모든 말을 생각하고 지친 듯이 요약했다."}},
        {"word":"wearily","part":"adv","pronunciation":"ˈwɪrəli","meanings":{"general":"지쳐서, 피곤하여. (파생어: weariness (n.) 피로, 권태, weary (adj.) 지친, 피곤한)","novel":"가족과 사회의 편견에 맞서는 데서 오는 정신적, 감정적 소모를 나타냅니다. 데이나가 '지쳐서' 가족의 반응을 요약하는 모습은, 그녀가 겪는 싸움이 개인적인 사랑을 넘어선 사회적인 투쟁임을 보여줍니다.","example":"I looked at my hands, thinking about all they had said, paring it down wearily.","translation":"나는 손을 내려다보며 그들이 했던 모든 말을 생각하고 지친 듯이 요약했다."}},
        {"word":"agonizingly","part":"adv","pronunciation":"ˈæɡənaɪzɪŋli","meanings":{"general":"고통스럽게, 괴롭게. (파생어: agony (n.) 극심한 고통, agonize (v.) 고뇌하다, agonizing (adj.) 고통스러운)","novel":"과거의 폭력이 남긴 육체적 고통의 생생함을 전달합니다. 채찍질로 상처 입은 등이 '고통스럽게' 늘어나는 묘사는, 데이나가 겪는 고통이 단순한 기억이 아니라 현재 진행형인 실제적 고통임을 강조합니다.","example":"The skin of my back stretched agonizingly, and the water got pinker.","translation":"등의 피부가 고통스럽게 늘어났고, 물은 더 분홍색이 되었다."}},
        {"word":"stumble into","part":"phrasal v","pronunciation":"ˈstʌmbl ˈɪntuː","meanings":{"general":"우연히 들어가다, 비틀거리며 들어가다. (파생어: stumble (n./v.) 비틀거림, 비틀거리다)","novel":"육체적, 정신적 탈진 상태를 보여줍니다. 데이나가 침실로 '비틀거리며 들어가' 침대에 쓰러지는 모습은, 과거에서 겪은 폭력과 트라우마가 그녀의 현재를 얼마나 무력하게 만드는지를 보여줍니다.","example":"I stumbled into the bedroom and fell across the bed.","translation":"나는 침실로 비틀거리며 들어가 침대 위로 쓰러졌다."}},
        {"word":"passably","part":"adv","pronunciation":"ˈpæsəbli","meanings":{"general":"그런대로, 어지간히. (파생어: passable (adj.) 그런대로 괜찮은, pass (v.) 지나가다)","novel":"폭력으로 인해 훼손된 인간 존엄성을 회복하려는 처절한 노력을 나타냅니다. 데이나가 '그런대로' 인간다운 모습으로 보일 때까지 자신을 씻고 정돈하는 것은, 생존을 위해 자신의 외모와 정신을 통제하려는 의지를 보여줍니다.","example":"When I looked passably human again, I took some aspirins.","translation":"내가 그럭저럭 사람처럼 보이게 되었을 때, 나는 아스피린 몇 알을 먹었다."}},
        {"word":"drawstring","part":"n","pronunciation":"ˈdrɔːstrɪŋ","meanings":{"general":"(주머니나 옷의) 조임끈.","novel":"데이나가 과거로 끌려갈 때를 대비해 준비하는 생존 도구의 일부입니다. '조임끈'으로 가방을 묶는 행위는, 예측 불가능한 위험 속에서 자신의 생존에 필요한 최소한의 물건들을 어떻게든 지키려는 필사적인 노력을 상징합니다.","example":"I tied it shut with its own rope drawstring, and tied the drawstring around my arm.","translation":"나는 가방 자체의 밧줄 조임끈으로 그것을 묶고, 그 조임끈을 내 팔에 묶었다."}},
        {"word":"incongruously","part":"adv","pronunciation":"ɪnˈkɑːŋɡruəsli","meanings":{"general":"어울리지 않게, 부조화스럽게. (파생어: incongruous (adj.) 어울리지 않는, incongruity (n.) 부조화)","novel":"극심한 트라우마 속에서도 나타나는 기본적인 생존 본능의 아이러니를 보여줍니다. 끔찍한 경험 직후 '어울리지 않게' 배고픔을 느끼는 데이나의 모습은, 정신적 고통과 육체적 필요 사이의 괴리를 드러내며 생명의 끈질김을 보여줍니다.","example":"Then, incongruously, I was hungry.","translation":"그러고 나서, 어울리지 않게, 나는 배가 고팠다."}},
        {"word":"laceration","part":"n","pronunciation":"ˌlæsəˈreɪʃn","meanings":{"general":"찢어진 상처, 열상. (파생어: lacerate (v.) 찢다, 상처를 입히다)","novel":"노예제 하에서 가해지는 폭력의 잔혹성을 구체적으로 보여주는 단어입니다. '채찍으로 인한 찢어진 상처'는 단순한 멍이나 타박상을 넘어, 살이 찢겨나가는 극심한 신체적 손상을 의미하며, 그 고통의 깊이를 전달합니다.","example":"The whip lacerations hurt like burns.","translation":"채찍으로 인한 찢어진 상처들은 화상처럼 아팠다."}},
        {"word":"limber","part":"adj","pronunciation":"ˈlɪmbər","meanings":{"general":"유연한, 나 유연한. (파생어: limberly (adv.) 유연하게)","novel":"폭력의 도구가 어떻게 유지되고 관리되는지에 대한 소름 끼치는 세부 사항을 드러냅니다. 채찍을 기름과 피로 '유연하게' 유지한다는 묘사는, 폭력이 일상적이고 체계적으로 관리되는 잔인한 현실을 보여줍니다.","example":"...a whip kept limber with oil and blood.","translation":"기름과 피로 유연하게 유지된 채찍."}},
        {"word":"mesh","part":"v","pronunciation":"meʃ","meanings":{"general":"딱 들어맞다, 맞물리다. (파생어: mesh (n.) 그물망)","novel":"데이나의 시간 여행이 끝나는 순간의 초현실적이고 끔찍한 경험을 묘사합니다. 그녀의 팔이 벽과 '맞물려' 하나가 되는 묘사는, 과거의 폭력이 현재의 육체에까지 침투하여 돌이킬 수 없는 상처를 남기는 과정을 상징적으로 보여줍니다.","example":"...meshing with it as though somehow my arm were being absorbed into something.","translation":"마치 내 팔이 무언가에 흡수되는 것처럼 그것과 맞물렸다."}},
        {"word":"strand","part":"v","pronunciation":"strænd","meanings":{"general":"오도 가도 못하게 하다, 발을 묶다.","novel":"시간 여행이 가진 가장 큰 위험 중 하나를 나타냅니다. 케빈이 과거에 '발이 묶이게' 될 수도 있다는 데이나의 두려움은, 그들의 관계를 위협하고, 개인이 거대한 역사의 힘 앞에서 얼마나 무력한지를 보여줍니다.","example":"That means if we’re separated, you’re stranded here for years, maybe for good.","translation":"그 말은 만약 우리가 헤어지면, 당신은 여기서 몇 년, 어쩌면 영원히 발이 묶인다는 뜻이다."}},
        {"word":"wiry","part":"adj","pronunciation":"ˈwaɪəri","meanings":{"general":"강단 있는, 여위지만 강인한. (파생어: wiriness (n.) 강인함)","novel":"노동으로 단련된 노예의 신체적 강인함을 묘사합니다. 아이작이 말랐지만 '강인해' 보이는 모습은, 억압적인 환경 속에서도 생존하고 저항할 수 있는 힘이 육체에 깃들어 있음을 보여줍니다.","example":"...but in spite of the black man’s slenderness, he looked wiry and strong.","translation":"그러나 그 흑인 남자의 날씬함에도 불구하고, 그는 강인하고 강해 보였다."}},
        {"word":"conditioning","part":"n","pronunciation":"kənˈdɪʃənɪŋ","meanings":{"general":"조건화, 훈련, 길들이기. (파생어: condition (n./v.) 조건, 길들이다, conditional (adj.) 조건부의)","novel":"노예제의 비인간적인 환경이 개인에게 미치는 영향을 나타냅니다. 아이작의 강인함이 수년간의 힘든 노동으로 '조건화'된 결과라는 설명은, 그의 힘이 생존을 위한 투쟁의 산물임을 보여줍니다. 동시에, 이는 노예들이 복종하도록 '길들여지는' 과정을 암시하기도 합니다.","example":"A lifetime of conditioning could be overcome, but not easily.","translation":"평생의 조건화는 극복될 수 있었지만, 쉽지는 않았다."}},
        {"word":"nudge","part":"v","pronunciation":"nʌdʒ","meanings":{"general":"(주의를 끌기 위해 팔꿈치로) 쿡 찌르다. (파생어: nudge (n.) 쿡 찌르기)","novel":"경멸과 무시의 표현으로 사용됩니다. 앨리스가 쓰러진 루퍼스를 발로 '쿡 찌르는' 행위는, 그에 대한 깊은 증오와 그를 더 이상 인간으로 존중하지 않겠다는 태도를 보여주는 비언어적 행동입니다.","example":"She nudged Rufus with her foot.","translation":"그녀는 발로 루퍼스를 쿡 찔렀다."}},
        {"word":"on the verge of","part":"idiom","pronunciation":"","meanings":{"general":"막 ~하려는, ~하기 직전의.","novel":"폭력이 폭발하기 직전의 극도의 긴장 상태를 묘사합니다. 루퍼스가 '막 총을 쏘기 직전'인 모습은, 그의 감정이 통제 불능 상태에 이르렀으며, 데이나와 케빈의 생명이 위태로운 순간임을 보여줍니다.","example":"He sort of crouched around the gun, clearly on the verge of firing.","translation":"그는 총 주위에 몸을 웅크렸는데, 명백히 발사 직전이었다."}},
        {"word":"at stake","part":"idiom","pronunciation":"","meanings":{"general":"위태로운, 성패가 달려 있는.","novel":"개인의 행동이 자신뿐만 아니라 다른 사람의 생명에까지 영향을 미치는 노예제의 잔혹한 현실을 보여줍니다. 아이작의 저항은 단순히 개인의 복수가 아니라, 그의 '생명이 위태로운' 상황임을 강조하며, 그의 선택의 무게를 보여줍니다.","example":"Isaac’s life was at stake.","translation":"아이작의 목숨이 위태로웠다."}},
        {"word":"vindictive","part":"adj","pronunciation":"vɪnˈdɪktɪv","meanings":{"general":"앙심을 품은, 보복적인. (파생어: vindictively (adv.) 보복적으로, vindictiveness (n.) 앙심)","novel":"권력자가 자신의 상처 입은 자존심을 잔인한 보복으로 되갚으려는 성향을 나타냅니다. 데이나는 루퍼스가 충분히 '보복적'이어서, 자신을 때린 아이작을 죽일 수도 있다고 걱정하며, 이는 노예의 생명이 주인의 감정에 따라 얼마나 쉽게 위협받을 수 있는지를 보여줍니다.","example":"If Rufus was vindictive enough, he could surely have the man killed.","translation":"만약 루퍼스가 충분히 앙심을 품었다면, 그는 분명 그 남자를 죽게 할 수 있었을 것이다."}},
        {"word":"gingerly","part":"adv","pronunciation":"ˈdʒɪndʒərli","meanings":{"general":"조심스럽게. (파생어: gingerliness (n.) 조심스러움)","novel":"폭행으로 인한 극심한 고통을 묘사합니다. 루퍼스가 자신의 옆구리를 '조심스럽게' 만지는 모습은, 아이작의 구타가 얼마나 심각한 부상을 입혔는지를 간접적으로 보여주며, 그의 육체적 고통을 전달합니다.","example":"He moaned and felt his side gingerly.","translation":"그는 신음하며 조심스럽게 옆구리를 만졌다."}},
        {"word":"petulantly","part":"adv","pronunciation":"ˈpetʃələntli","meanings":{"general":"심술 내며, 성질부리며. (파생어: petulant (adj.) 심술을 부리는, petulance (n.) 성마름)","novel":"루퍼스의 미성숙하고 자기중심적인 성격을 보여줍니다. 심각한 상황에서도 데이나가 자신을 잠시 떠난 것에 대해 어린아이처럼 '심술을 내며' 말하는 모습은, 그가 타인의 감정이나 상황을 이해하지 못하는 이기적인 인물임을 드러냅니다.","example":"“Why didn’t you tell me that’s where you were going?” he said petulantly.","translation":"“어디 가는지 왜 말 안 했어?” 그가 심술궂게 말했다."}},
        {"word":"retaliation","part":"n","pronunciation":"rɪˌtæliˈeɪʃn","meanings":{"general":"보복, 앙갚음. (파생어: retaliate (v.) 보복하다, retaliatory (adj.) 보복적인)","novel":"데이나와 루퍼스 사이의 위험하고 불안정한 권력 관계를 정의합니다. 서로에게 '보복'할 기회가 너무 많다는 데이나의 말은, 그들의 관계가 신뢰가 아닌, 상호 파괴의 가능성에 기반한 위태로운 균형 위에 서 있음을 보여줍니다.","example":"We both have too much opportunity for retaliation.","translation":"우리 둘 다 보복할 기회가 너무 많다."}},
        {"word":"speckle with","part":"v","pronunciation":"ˈspekl wɪθ","meanings":{"general":"~으로 얼룩지게 하다, 반점을 찍다. (파생어: speckle (n.) 작은 반점)","novel":"절박한 상황에서 생존을 위해 주변 환경을 이용하는 데이나의 기지를 보여줍니다. 그녀가 길을 잃지 않기 위해 하얀 종잇조각으로 '얼룩진' 바리케이드를 만드는 모습은, 현대적인 도구 없이 원시적인 방법으로 위기를 헤쳐나가려는 그녀의 노력을 상징합니다.","example":"I pulled up some bushes and made a kind of barricade speckled with bits of white paper.","translation":"나는 덤불 몇 개를 뽑아 흰 종잇조각으로 얼룩진 일종의 바리케이드를 만들었다."}},
        {"word":"scab","part":"n","pronunciation":"skæb","meanings":{"general":"(상처의) 딱지. (파생어: scab (v.) 딱지가 생기다)","novel":"과거의 폭력이 현재에 남긴 지울 수 없는 육체적 흔적을 상징합니다. 데이나가 등의 '딱지'를 만지며 실수를 되풀이하지 않겠다고 다짐하는 것은, 고통의 기억이 그녀의 행동을 통제하고 생존 전략의 일부가 되었음을 보여줍니다.","example":"I rubbed my back, touched the several long scabs to remind myself that I could not afford to make mistakes.","translation":"나는 실수를 할 여유가 없다는 것을 상기하기 위해 등을 문지르고 여러 개의 긴 딱지를 만졌다."}},
        {"word":"apprehension","part":"n","pronunciation":"ˌæprɪˈhenʃn","meanings":{"general":"우려, 불안, 체포. (파생어: apprehend (v.) 체포하다, 우려하다, apprehensive (adj.) 불안한, 걱정되는)","novel":"예상치 못한 만남에서 오는 즉각적인 긴장과 불안감을 나타냅니다. 데이나가 인기척에 '빠른 불안감'을 느끼며 돌아보는 모습은, 노예제 사회에서 낯선 사람과의 만남이 잠재적인 위협이 되는 위험한 현실을 반영합니다.","example":"There was a sound behind me and I turned in quick apprehension.","translation":"내 뒤에서 소리가 나서 나는 재빨리 불안해하며 돌아섰다."}},
        {"word":"half-curtsey","part":"n","pronunciation":"hæf ˈkɜːrtsi","meanings":{"general":"반쯤 엉거주춤하게 하는 절. (파생어: curtsey (n./v.) (여성의) 절, 절하다)","novel":"노예들이 백인 주인에게 보여야 하는 복종적인 태도를 상징합니다. 캐리가 '반쯤 절하는' 듯한 몸짓을 하는 것은, 말로 표현할 수 없는 상황에서 몸에 밴 복종의 자세를 통해 소통하고 자신의 위치를 확인하는 모습을 보여줍니다.","example":"She gave the half-nod, half-curtsey that she reserved for whites and hurried away.","translation":"그녀는 백인들에게만 보이는, 반쯤 고개를 끄덕이고 반쯤 절하는 인사를 하고 서둘러 떠났다."}},
        {"word":"stocky","part":"adj","pronunciation":"ˈstɑːki","meanings":{"general":"다부진, 땅딸막한. (파생어: stockily (adv.) 다부지게, stockiness (n.) 다부짐)","novel":"노동으로 단련된 노예들의 강인한 신체를 묘사합니다. 나이젤이 '다부진' 체격의 남자로 성장한 모습은, 어린 시절의 연약함을 극복하고 억압적인 환경 속에서 살아남아 강인한 존재가 되었음을 시각적으로 보여줍니다.","example":"A tall stocky slave drove a wagon around to us and I got on the back while Weylin took the seat beside the driver.","translation":"키가 크고 다부진 노예가 우리 쪽으로 마차를 몰았고, 웨일린이 마부 옆자리에 앉는 동안 나는 뒤에 올라탔다."}},
        {"word":"just out of meanness","part":"idiom","pronunciation":"","meanings":{"general":"순전히 심술 때문에, 악의에서. (파생어: mean (adj.) 비열한, meanness (n.) 비열함)","novel":"루퍼스의 폭력성이 이유 없는 악의에서 비롯될 수 있음을 보여줍니다. 사라가 그가 '순전히 심술 때문에' 싸움을 건다고 말하는 것은, 그의 행동이 종종 논리적인 이유 없이, 단지 타인에게 고통을 주기 위한 충동적인 악의에서 비롯됨을 드러냅니다.","example":"I’ve seen him pick a fight just out of meanness.","translation":"나는 그가 순전히 심술 때문에 싸움을 거는 것을 본 적이 있다."}},
        {"word":"thrash about weakly","part":"v phr","pronunciation":"θræʃ əˈbaʊt ˈwiːkli","meanings":{"general":"힘없이 몸부림치다. (파생어: thrash (v.) 몸부림치다, 때리다)","novel":"병에 걸린 루퍼스의 극심한 고통과 무력함을 생생하게 묘사합니다. 그가 침대에서 '힘없이 몸부림치는' 모습은, 그가 겪는 질병이 얼마나 심각한지를 보여주며, 데이나의 도움이 절실한 상황임을 나타냅니다.","example":"He was thrashing about weakly when I went back to him.","translation":"내가 그에게 돌아갔을 때 그는 힘없이 몸부림치고 있었다."}}
    ],
            "The Storm": [
        {"word":"knob","part":"n","pronunciation":"nɑːb","meanings":{"general":"(기계 등을 조작하는) 손잡이, 스위치.","novel":"과거에 5년간 갇혀 있던 케빈이 현대 문물에 느끼는 낯설음과 단절감을 상징합니다. 그가 TV의 '손잡이'를 어색하게 만지는 모습은, 그가 더 이상 1976년에 속하지 못하는 이방인이 되었음을 보여주며, 시간 여행이 남긴 깊은 후유증을 드러냅니다.","example":"I found him in the living room trying knobs on the television set.","translation":"나는 거실에서 텔레비전의 손잡이를 만지작거리고 있는 그를 발견했다."}},
        {"word":"rug","part":"n","pronunciation":"rʌɡ","meanings":{"general":"깔개, 양탄자.","novel":"현대 생활의 안락함과 평범함을 상징합니다. 케빈이 분노에 차 연필깎이를 내던졌을 때, 그것이 '깔개'를 아슬아슬하게 빗나가는 장면은, 그의 내면의 폭력성이 평화로운 일상을 깨뜨릴 수 있는 위태로운 경계에 있음을 보여줍니다.","example":"The sharpener bounced hard on the bare floor, just missing the rug.","translation":"연필깎이는 마루 바닥에 세게 튕겨져 나갔고, 간신히 깔개를 비켜갔다."}},
        {"word":"stalk","part":"v","pronunciation":"stɔːk","meanings":{"general":"성큼성큼 걷다, 쫓아다니며 괴롭히다.","novel":"케빈의 좌절감과 분노에 찬 무력감을 표현합니다. 그가 오븐 문을 쾅 닫고 '성큼성큼 걸어가는' 모습은, 현대 문물에 대한 낯설음과 자신의 무력함에 대한 깊은 분노가 담긴 행동으로, 그의 심리적 고통을 보여줍니다.","example":"Before I could say anything, he slammed the oven door and stalked away shaking his head.","translation":"내가 무슨 말을 하기도 전에, 그는 오븐 문을 쾅 닫고는 고개를 저으며 성큼성큼 걸어가 버렸다."}},
        {"word":"Excedrin","part":"n","pronunciation":"ɪkˈsedrɪn","meanings":{"general":"엑세드린 (두통약 브랜드 이름).","novel":"현대 의학의 즉각적인 고통 완화 능력을 상징합니다. 과거 시대의 끔찍한 고통과 대비되는 이 '두통약'은, 데이나가 가진 문명 세계의 작은 위안이자 생존 도구입니다. 그녀가 이것을 챙기는 행위는 미래의 고통에 대비하는 절박함을 보여줍니다.","example":"...Kevin’s large bottle of Excedrin, and an old pocket knife to replace the switchblade.","translation":"...케빈의 커다란 엑세드린 병과, 스위치 블레이드를 대신할 낡은 주머니칼."}},
        {"word":"supremacist","part":"n","pronunciation":"suˈpreməsɪst","meanings":{"general":"우월주의자. (파생어: supremacy (n.) 우월, 패권)","novel":"남아프리카의 아파르트헤이트와 미국의 노예제를 연결하며 인종차별의 보편성과 지속성을 비판합니다. '백인 우월주의자' 정부에 대한 뉴스는, 데이나가 막 탈출해온 19세기 노예제가 시공간을 넘어 현대에도 다른 형태로 존재하고 있음을 상기시킵니다.","example":"...police over the policies of the white supremacist government.","translation":"...백인 우월주의 정부의 정책에 대해 경찰과 충돌했다."}},
        {"word":"harrow","part":"v","pronunciation":"ˈhæroʊ","meanings":{"general":"정신적으로 몹시 괴롭히다. (파생어: harrowing (adj.) 끔찍한, 참혹한)","novel":"톰 웨일린과의 대화가 주는 극심한 정신적 고통을 나타냅니다. 그와의 대화가 항상 '괴로웠다'는 데이나의 회상은, 그의 권위적인 태도와 예측 불가능한 폭력성이 노예들에게 끊임없는 심리적 압박과 공포를 주었음을 보여줍니다.","example":"When he did, it was always harrowing.","translation":"그가 말을 걸 때면, 항상 끔찍했다."}},
        {"word":"scrawny","part":"adj","pronunciation":"ˈskrɔːni","meanings":{"general":"뼈만 앙상한, 수척한.","novel":"톰 웨일린의 육체적 쇠약함과 대조되는 그의 폭력적인 권위를 강조합니다. 데이나가 그의 '수척한' 목을 부러뜨릴 수 있다고 생각하는 것은, 육체적 힘의 우위에도 불구하고 사회적 신분 때문에 저항할 수 없는 노예제의 모순적인 권력 구조를 드러냅니다.","example":"I realized then, though, that if he ever hit me again, I would break his scrawny neck.","translation":"하지만 그때 나는 깨달았다, 만약 그가 다시 한번 나를 때린다면, 나는 그의 깡마른 목을 부러뜨릴 것이라고."}},
        {"word":"flay","part":"v","pronunciation":"fleɪ","meanings":{"general":"가죽을 벗기다, 껍질을 벗기다.","novel":"노예 소유주가 가할 수 있는 가장 극단적이고 잔인한 고문을 의미합니다. 웨일린이 데이나에게 '산 채로 가죽을 벗기겠다'고 위협하는 것은, 그의 분노가 얼마나 치명적인 폭력으로 이어질 수 있는지를 보여주는 소름 끼치는 경고입니다.","example":"If anything happens to him, I’ll flay you alive!","translation":"만약 그에게 무슨 일이 생기면, 나는 너를 산 채로 가죽을 벗길 것이다!"}},
        {"word":"enforceable","part":"adj","pronunciation":"ɪnˈfɔːrsəbl","meanings":{"general":"시행 가능한, 집행 가능한. (파생어: enforce (v.) 집행하다, enforcement (n.) 집행)","novel":"노예제 사회에서 흑인이 법적으로 아무런 보호도 받지 못하는 완전한 무권리 상태를 강조합니다. 데이나가 자신에게는 '집행 가능한' 권리가 전혀 없음을 깨닫는 순간은, 그녀의 생명과 안전이 전적으로 주인의 변덕에 달려 있음을 보여주는 절망적인 현실 인식입니다.","example":"He could do anything he wanted to to me, and I had no enforceable rights.","translation":"그는 나에게 원하는 것은 무엇이든 할 수 있었고, 내게는 어떤 강제력 있는 권리도 없었다."}},
        {"word":"purging","part":"n","pronunciation":"ˈpɜːrdʒɪŋ","meanings":{"general":"정화, 숙청, 설사. (파생어: purge (v.) 제거하다)","novel":"19세기 의학의 비과학적이고 위험한 치료법을 비판합니다. 의사들이 '설사'나 사혈과 같은 방법으로 병을 치료하려 했다는 사실은, 당시 의학이 환자를 돕기보다 오히려 해를 끼칠 수 있었음을 보여주며, 데이나의 현대 지식과의 극명한 대조를 이룹니다.","example":"...bleeding and blistering and purging and puking...","translation":"...피를 뽑고, 물집을 만들고, 설사를 시키고, 토하게 하는 것..."}},
        {"word":"ague","part":"n","pronunciation":"ˈeɪɡjuː","meanings":{"general":"(옛날 말) 학질, 오한.","novel":"말라리아를 지칭하는 당시의 용어로, 질병에 대한 19세기의 제한된 이해를 보여줍니다. 나이젤이 루퍼스의 병을 대수롭지 않게 '학질'이라고 부르는 모습은, 질병의 원인과 전염 경로에 대한 무지가 어떻게 더 큰 위험을 초래할 수 있는지를 보여줍니다.","example":"Got the ague again, I guess.","translation":"또 학질에 걸렸나 봐."}},
        {"word":"mumps","part":"n","pronunciation":"mʌmps","meanings":{"general":"볼거리, 유행성 이하선염.","novel":"데이나가 가진 현대 의학 지식과 과거 사람들의 무지를 대조적으로 보여줍니다. 그녀가 아이들의 증상을 보고 즉시 '볼거리'를 떠올리는 것은, 질병을 정확히 진단하고 대처할 수 있는 현대인의 능력과, 그렇지 못한 과거 시대의 한계를 드러냅니다.","example":"Some of the children are sick, but I think they have something wrong with their faces—one side all swollen up.” Mumps?","translation":"아이들 몇몇이 아픈데, 얼굴에 이상이 생긴 것 같아요. 한쪽이 다 부었거든요.” 볼거리인가?"}},
        {"word":"miasma","part":"n","pronunciation":"maɪˈæzmə","meanings":{"general":"(지저분한 곳에서 생기는) 독기, 나쁜 공기.","novel":"말라리아의 원인에 대한 19세기의 잘못된 의학 이론(독기설)을 보여줍니다. 의사가 병의 원인을 '독기'라고 설명하는 것은, 과학적 근거가 부족했던 당시 의학의 한계를 드러내며, 데이나가 가진 '모기가 병을 옮긴다'는 현대 지식과 정면으로 배치됩니다.","example":"A miasma, he called it.","translation":"그는 그것을 독기라고 불렀다."}},
        {"word":"grisly","part":"adj","pronunciation":"ˈɡrɪzli","meanings":{"general":"소름 끼치는, 섬뜩한.","novel":"당시 의술의 잔혹함에 대한 냉소적인 유머를 담고 있습니다. 나이젤이 의사가 팔다리를 자르는 데는 능숙하다고 말했을 때, 데이나는 그가 '소름 끼치는' 농담을 하는 것인지 의심합니다. 이는 수술이 마취 없이 이루어지던 시대의 공포를 암시합니다.","example":"I had to look at Nigel to see whether he was making a grisly joke.","translation":"나는 나이젤이 섬뜩한 농담을 하는 것인지 확인하기 위해 그를 쳐다봐야 했다."}},
        {"word":"quell","part":"v","pronunciation":"kwel","meanings":{"general":"(반란 등을) 진압하다, (감정을) 억누르다.","novel":"혐오스러운 대상을 구해야 하는 데이나의 내적 갈등을 보여줍니다. 그녀가 톰 웨일린에게 인공호흡을 하기 위해 '역겨움을 억누르는' 모습은, 자신의 감정보다 생명을 구해야 한다는 인도주의적 의무감, 그리고 그를 살려야만 하는 복잡한 상황을 드러냅니다.","example":"Then quelling disgust, I began mouth to mouth resuscitation...","translation":"그런 다음 혐오감을 억누르고, 나는 입을 맞대고 인공호흡을 시작했다..."}},
        {"word":"herded","part":"v","pronunciation":"hɜːrdɪd","meanings":{"general":"(가축처럼) 몰다. (파생어: herd (n.) 떼, 무리)","novel":"노예들이 인간이 아닌 가축처럼 취급당하는 비인간적인 현실을 보여줍니다. 데이나가 감독관에 의해 옥수수밭으로 '몰리는' 모습은, 노예에게는 개인의 의지나 존엄성이 허락되지 않고, 오직 주인의 명령에 따라 움직이는 존재임을 드러냅니다.","example":"I took the sicklelike corn knife Fowler thrust into my hands and let myself be herded out toward the cornfield.","translation":"나는 파울러가 내 손에 찔러준 낫 모양의 옥수수 칼을 받아들고 옥수수밭으로 몰려갔다."}},
        {"word":"groin","part":"n","pronunciation":"ɡrɔɪn","meanings":{"general":"사타구니, 서혜부.","novel":"노예 소유주 사이에도 존재하는 폭력의 수위에 대한 미묘한 차이를 보여줍니다. 톰 웨일린은 노예 남성의 '사타구니'를 차는 행위는 하지 않았다는 데이나의 생각은, 그가 파울러와 같은 감독관보다는 덜 야만적이었음을 암시하지만, 이는 상대적인 차이일 뿐 노예제의 근본적인 폭력성을 희석시키지는 못합니다.","example":"...any more than he’d kicked slave men in the groin.","translation":"...그가 노예 남자들의 사타구니를 걷어차는 것 이상으로."}},
        {"word":"cringe","part":"v","pronunciation":"krɪndʒ","meanings":{"general":"(두려움으로) 움츠리다, 민망하다.","novel":"반복되는 폭력과 위협이 개인을 어떻게 심리적으로 길들이는지를 보여줍니다. 데이나가 감독관의 목소리만 들어도 '움츠리게' 되는 자신의 모습에 충격받는 것은, 공포가 어떻게 반사적인 복종을 만들어내는지, 그리고 노예제가 어떻게 인간의 저항 의지를 꺾는지를 드러냅니다.","example":"I caught myself cringing, jumping at the sound of his voice.","translation":"나는 그의 목소리에 움찔하며 뛰어오르는 나 자신을 발견했다."}},
        {"word":"wilt","part":"v","pronunciation":"wɪlt","meanings":{"general":"시들다, 지치다.","novel":"권위적인 태도 뒤에 숨겨진 루퍼스의 심리적 약함과 데이나에 대한 의존성을 보여줍니다. 데이나가 그의 명령에 굴복하자 루퍼스가 '시드는' 모습은, 그의 공격적인 행동이 사실은 데이나를 잃을지도 모른다는 두려움에서 비롯된 방어기제였음을 드러냅니다.","example":"And he wilted.","translation":"그리고 그는 시들었다."}},
        {"word":"laudanum","part":"n","pronunciation":"ˈlɔːdənəm","meanings":{"general":"아편팅크 (진통제, 수면제로 쓰이던 아편 성분의 약물).","novel":"19세기에 널리 사용되었던 중독성 강한 약물로, 육체적, 정신적 고통으로부터의 도피를 상징합니다. 마가렛 웨일린이 '로더넘'에 의존하는 모습은, 그녀의 연약함과 현실을 직시하지 못하는 성격을 보여줍니다. 이후 앨리스가 탈출을 위해 이 약을 구하려는 것은, 생존을 위한 위험한 선택을 의미합니다.","example":"You give her her laudanum when she needs it and she won’t give you much trouble.","translation":"그녀가 필요할 때 로더넘을 주면, 그녀는 너에게 별로 문제를 일으키지 않을 것이다."}},
        {"word":"gauntness","part":"n","pronunciation":"ˈɡɔːntnəs","meanings":{"general":"수척함, 야윔. (파생어: gaunt (adj.) 수척한)","novel":"오랜 병고와 정신적 고통이 마가렛 웨일린의 외모에 남긴 흔적을 묘사합니다. 그녀의 아름다움이 '연약한 수척함'으로 변해버린 모습은, 그녀가 겪었을 고통의 깊이를 시각적으로 보여주며, 그녀의 쇠약해진 상태를 암시합니다.","example":"Her beauty had gone to a kind of fragile gauntness.","translation":"그녀의 아름다움은 일종의 연약한 수척함으로 변해 있었다."}},
        {"word":"beneficently","part":"adv","pronunciation":"bəˈnefɪsntli","meanings":{"general":"자비롭게, 인정 많게. (파생어: beneficence (n.) 선행, 은혜, beneficent (adj.) 자비로운)","novel":"로더넘(아편)의 영향으로 인한 마가렛 웨일린의 인위적인 평온 상태를 아이러니하게 묘사합니다. 그녀가 '자비롭게' 미소 짓는 모습은, 진정한 인격의 변화가 아니라 약물에 의해 만들어진 가식적인 태도임을 암시하며, 그녀의 상태에 대한 불안감을 조성합니다.","example":"As I was reintroduced to her, she sipped at her little bottle of dark brownish-red liquid and smiled beneficently.","translation":"내가 그녀에게 다시 소개되었을 때, 그녀는 짙은 갈색을 띤 붉은 액체가 담긴 작은 병을 홀짝이며 자비롭게 미소 지었다."}},
        {"word":"impudent","part":"adj","pronunciation":"ˈɪmpjədənt","meanings":{"general":"무례한, 버릇없는. (파생어: impudence (n.) 무례함)","novel":"노예 소유주가 노예의 독립적인 사고나 저항적인 태도를 묘사할 때 사용하는 경멸적인 단어입니다. 마가렛이 데이나를 '무례했다'고 평가하는 것은, 과거 데이나가 보여준 당당함과 지성이 지배 계급에게는 위협적이고 버릇없는 행동으로 인식되었음을 보여줍니다.","example":"You were impudent before.","translation":"너는 전에는 무례했었지."}},
        {"word":"thump","part":"v","pronunciation":"θʌmp","meanings":{"general":"쿵 하고 치다. (파생어: thump (n.) 쿵 하는 소리)","novel":"마가렛 웨일린이 자신의 권위를 행사하고 데이나를 호출하는 방식을 보여줍니다. 그녀가 지팡이로 바닥을 '쿵쿵 치는' 소리는, 말 한마디 없이도 하인을 부릴 수 있는 그녀의 지배적인 위치와, 데이나가 그에 복종해야 하는 예속적인 관계를 상징합니다.","example":"Upstairs, I could hear Margaret Weylin thumping on the floor with her cane.","translation":"위층에서 마가렛 웨일린이 지팡이로 바닥을 쿵쿵 치는 소리가 들렸다."}},
        {"word":"coffle","part":"n","pronunciation":"ˈkɔːfl","meanings":{"general":"(과거 쇠사슬이나 밧줄로 묶어 끌고 가던) 노예 한 무리.","novel":"노예 매매의 비인간성을 가장 직접적으로 보여주는 끔찍한 광경입니다. 사슬에 묶여 끌려가는 '노예 무리'의 모습은, 그들이 개별적인 인간이 아닌, 사고파는 상품이자 가축처럼 취급당하는 노예제의 잔혹한 현실을 시각적으로 충격적이게 전달합니다.","example":"A coffle—slaves for sale.","translation":"한 무리의 노예들—판매용 노예들이었다."}},
        {"word":"clasp","part":"v","pronunciation":"klæsp","meanings":{"general":"움켜쥐다, 껴안다. (파생어: clasp (n.) 걸쇠, 움켜쥠)","novel":"캐리가 말을 할 수 없는 상황에서 몸짓으로 소통하는 절박함을 보여줍니다. 그녀가 자신의 목을 '움켜쥐는' 행위는, 노예 매매가 자신과 가족에게도 닥칠 수 있는 실질적인 위협임을, 그리고 그 공포가 목을 조여오는 듯한 느낌임을 강렬하게 전달합니다.","example":"Carrie clasped her hands around her neck again.","translation":"캐리는 다시 두 손으로 목을 감쌌다."}},
        {"word":"dengue fever","part":"n","pronunciation":"ˈdeŋɡi ˈfiːvər","meanings":{"general":"뎅기열 (모기를 통해 전염되는 급성 열병).","novel":"루퍼스가 겪었던 질병의 정체로, 당시 의학의 진단 능력의 한계를 보여줍니다. 현대 의학의 병명을 알고 있는 데이나와 달리, 당시 의사는 이 병을 정확히 진단하지 못했으며, 이는 데이나의 지식이 루퍼스의 생존에 결정적이었음을 다시 한번 강조합니다.","example":"You ever hear of dengue fever?","translation":"뎅기열이라고 들어본 적 있어?"}},
        {"word":"knack","part":"n","pronunciation":"næk","meanings":{"general":"요령, 재주.","novel":"생존을 위한 본능적인 능력이나 기술을 의미합니다. 데이나가 루퍼스에게 '요령'이 없다고 말하는 것은, 그가 그녀의 도움 없이는 위험한 상황에서 살아남을 능력이 부족하다는 것을 지적하며, 그들의 상호 의존적인 관계를 강조합니다.","example":"I don’t think you have the knack.","translation":"내 생각에 너는 요령이 없는 것 같아."}},
        {"word":"stilted","part":"adj","pronunciation":"ˈstɪltɪd","meanings":{"general":"(말, 글이) 딱딱한, 부자연스러운.","novel":"19세기의 격식적이고 부자연스러운 문어체를 묘사합니다. 데이나가 당시의 '딱딱한' 문체에 적응하려는 노력은, 그녀가 단순히 생존하는 것을 넘어, 그 시대의 문화와 소통 방식에 스며들어 자신의 역할을 수행해야 하는 어려움을 보여줍니다.","example":"I had to read several of the letters he’d received first to pick up the stilted formal style of the day.","translation":"나는 당시의 딱딱하고 격식 있는 문체를 익히기 위해 그가 받은 편지 몇 통을 먼저 읽어야 했다."}},
        {"word":"eligible","part":"adj","pronunciation":"ˈelɪdʒəbl","meanings":{"general":"자격이 있는, 바람직한. (파생어: eligibility (n.) 적격성)","novel":"노예 소유주로서의 루퍼스의 사회적 지위를 나타냅니다. 그가 재산과 노예를 소유하고 있기 때문에 결혼 상대로서 '바람직하다'고 여겨지는 현실은, 인간을 소유하는 것이 부와 권력의 상징이었던 당시 사회의 비뚤어진 가치관을 보여줍니다.","example":"Rufus had property and slaves and was apparently quite eligible.","translation":"루퍼스는 재산과 노예를 가지고 있었고, 명백히 상당히 신랑감으로 적격이었다."}},
        {"word":"totter","part":"v","pronunciation":"ˈtɑːtər","meanings":{"general":"비틀거리다.","novel":"루퍼스의 불안정한 상태를 묘사하며, 그가 한 말이 진심인지 농담인지 알 수 없는 혼란스러움을 더합니다. 그가 '비틀거리며' 가버리는 모습은, 그가 데이나와 앨리스를 '하나의 여성'으로 보는 비정상적인 집착과 그의 불안한 심리 상태를 암시합니다.","example":"He tottered away.","translation":"그는 비틀거리며 가버렸다."}},
        {"word":"wistful","part":"adj","pronunciation":"ˈwɪstfl","meanings":{"general":"애틋한, 그리워하는. (파생어: wistfully (adv.) 애틋하게)","novel":"노예들이 젊은 남녀의 사랑을 바라보는 복잡한 감정을 묘사합니다. 그들이 젊은이들을 향해 '애틋한' 표정을 짓는 것은, 자신들이 누리지 못했던 자유로운 사랑에 대한 그리움과, 노예라는 신분 때문에 곧 닥칠 비극에 대한 안타까움이 뒤섞인 감정입니다.","example":"...or more understanding wistful looks.","translation":"...혹은 더 이해심 많고 애틋한 표정들."}},
        {"word":"tactlessly","part":"adv","pronunciation":"ˈtæktləsli","meanings":{"general":"눈치 없게, 요령 없게. (파생어: tactless (adj.) 요령 없는, tact (n.) 요령, 재치)","novel":"데이나가 자신의 현대적 가치관을 무심코 드러내어 위험을 초래할 수 있는 상황을 보여줍니다. 그녀가 톰 웨일린의 인색함을 '눈치 없이' 비판하는 것은, 비록 사실일지라도, 주인에게 직설적으로 말하는 것이 금지된 노예 사회의 규칙을 어기는 위험한 행동입니다.","example":"“Anything to pinch a few pennies,” I said tactlessly.","translation":"“몇 푼 아끼기 위해서라면 뭐든지,” 내가 눈치 없이 말했다."}},
        {"word":"creditor","part":"n","pronunciation":"ˈkredɪtər","meanings":{"general":"채권자.","novel":"농장 경영의 현실적인 어려움과 노예 매매의 경제적 동기를 보여줍니다. '채권자'들이 인내심을 보인 덕분에 루퍼스가 추가적인 노예 판매를 피할 수 있었다는 사실은, 노예들의 운명이 주인의 재정 상태에 따라 얼마나 쉽게 좌우될 수 있는지를 드러냅니다.","example":"The harvest had been good and the creditors patient.","translation":"수확은 좋았고 채권자들은 인내심이 있었다."}},
        {"word":"banjo","part":"n","pronunciation":"ˈbændʒoʊ","meanings":{"general":"밴조 (악기).","novel":"노예들의 문화와 공동체의 즐거움을 상징하는 중요한 요소입니다. 크리스마스 파티에서 노예들이 '밴조' 음악에 맞춰 춤추는 모습은, 억압적인 현실 속에서도 기쁨과 유대를 찾으려는 그들의 인간적인 모습을 보여줍니다.","example":"...watching the slaves do a bowing, partner-changing dance to the music of a banjo.","translation":"...노예들이 밴조 음악에 맞춰 절을 하고 파트너를 바꾸는 춤을 추는 것을 지켜보며."}},
        {"word":"stalk away","part":"phrasal v","pronunciation":"stɔːk əˈweɪ","meanings":{"general":"성큼성큼 화가 나서 가버리다.","novel":"데이나의 말에 상처받고 분노한 루퍼스의 반응을 보여줍니다. 그가 '화가 나서 성큼성큼 가버리는' 모습은, 데이나가 자신의 소유가 아닌 케빈의 아내라는 사실을 인정하고 싶지 않은 그의 미성숙함과 질투심을 드러냅니다.","example":"He stalked away angrily.","translation":"그는 화를 내며 성큼성큼 가버렸다."}},
        {"word":"elude","part":"v","pronunciation":"iˈluːd","meanings":{"general":"(교묘히) 피하다, 이해할 수 없다. (파생어: elusive (adj.) 찾기 힘든)","novel":"배움에 대한 조의 열정과 지적 호기심을 강조합니다. 그가 이해되지 않는 것에 부딪혔을 때 좌절하는 모습은, 루퍼스의 무관심과 대조적으로, 지식이 그에게 얼마나 중요한지를 보여주며, 이는 미래의 희망을 상징합니다.","example":"He could get so intense—throw screaming kicking tantrums when something seemed to be eluding him.","translation":"그는 무언가 이해되지 않을 때 소리를 지르고 발길질을 하며 난리를 칠 정도로 매우 격렬해질 수 있었다."}},
        {"word":"hedge","part":"v","pronunciation":"hedʒ","meanings":{"general":"얼버무리다, 확답을 피하다.","novel":"데이나가 앨리스에게 진실을 말하기를 주저하는 내적 갈등을 보여줍니다. 그녀가 '얼버무리며' 앨리스의 탈출 계획에 대한 질문을 피하는 것은, 앨리스를 돕고 싶은 마음과 그녀가 겪게 될 위험에 대한 두려움 사이에서 고뇌하는 복잡한 심리를 드러냅니다.","example":"I hedged a little.","translation":"나는 약간 얼버무렸다."}}
    ],
    "The Rope": [
        {"word":"thatch","part":"n","pronunciation":"θætʃ","meanings":{"general":"초가지붕, 짚, 덥수룩한 머리. (파생어: thatched (adj.) 초가지붕의)","novel":"5년 동안 과거에 갇혀있던 케빈의 외모 변화를 묘사하며, 그가 겪은 시간의 흐름과 고난을 상징합니다. 그의 '덥수룩한' 머리카락은 문명과 단절된 채 보낸 세월의 흔적이며, 그가 더 이상 1976년의 케빈이 아님을 시각적으로 보여줍니다.","example":"I could see him beardless now, but with his thatch of gray hair uncut.","translation":"나는 이제 수염이 없는 그를 볼 수 있었지만, 그의 덥수룩한 회색 머리카락은 자르지 않은 채였다."}},
        {"word":"gangrene","part":"n","pronunciation":"ˈɡæŋɡriːn","meanings":{"general":"괴저 (조직의 괴사). (파생어: gangrenous (adj.) 괴저성의)","novel":"19세기 의료 수준의 한계에 대한 데이나의 공포를 나타냅니다. 그녀가 수면제를 사용해 집으로 돌아오는 방법의 부작용으로 '괴저'를 걱정하는 것은, 현대 의학 지식을 가진 그녀가 과거 시대의 비과학적인 치료와 그로 인한 끔찍한 결과를 얼마나 두려워하는지를 보여줍니다.","example":"Or that if I didn’t die, I’d have some grisly side effect—like gangrene.”","translation":"혹은 만약 내가 죽지 않더라도, 괴저와 같은 소름 끼치는 부작용이 생길 수도 있었다.”"}},
        {"word":"grisly","part":"adj","pronunciation":"ˈɡrɪzli","meanings":{"general":"소름 끼치는, 섬뜩한. (파생어: grisliness (n.) 소름 끼침)","novel":"자신을 해쳐 집으로 돌아가야 하는 데이나의 선택이 가진 끔찍한 위험성을 강조합니다. 그녀가 '소름 끼치는' 부작용을 언급하는 것은, 그녀의 자해 시도가 단순한 전략이 아니라, 죽음이나 끔찍한 신체 훼손을 감수해야 하는 절박하고 위험한 행위임을 드러냅니다.","example":"Or that if I didn’t die, I’d have some grisly side effect—like gangrene.”","translation":"혹은 만약 내가 죽지 않더라도, 괴저와 같은 소름 끼치는 부작용이 생길 수도 있었다.”"}},
        {"word":"fixture","part":"n","pronunciation":"ˈfɪkstʃər","meanings":{"general":"붙박이 가구, 고정된 것, 늘 있는 사람.","novel":"루퍼스가 데이나의 삶에 얼마나 깊숙이, 그리고 영구적으로 자리 잡았는지를 보여줍니다. 그가 이름조차 부를 필요 없는 '늘 있는 존재'가 되었다는 사실은, 그들의 관계가 선택이 아닌, 벗어날 수 없는 운명적인 족쇄임을 나타냅니다.","example":"He had become such a fixture in my life that it wasn’t even necessary to say his name.","translation":"그는 내 삶의 너무나 당연한 일부가 되어버려서 그의 이름을 부를 필요조차 없었다."}},
        {"word":"breeding","part":"n","pronunciation":"ˈbriːdɪŋ","meanings":{"general":"번식, 사육. (파생어: breed (v./n.) 새끼를 낳다, 품종)","novel":"노예 여성을 인간이 아닌 가축으로 취급하는 노예제의 비인간성을 극명하게 드러냅니다. 케빈이 노예 여성이 새 주인에게 팔려가 아이를 낳는 것을 '번식'이라고 표현하는 것은, 노예제가 사랑이나 가족 관계를 완전히 무시하고 오직 재산 증식의 수단으로만 여성을 이용했음을 보여줍니다.","example":"Someone would buy her and breed her to a new man. It is breeding, you know.”","translation":"누군가가 그녀를 사서 새로운 남자와 짝을 지어 새끼를 낳게 할 것이다. 그건 번식이야, 알다시피.”"}},
        {"word":"buggy","part":"n","pronunciation":"ˈbʌɡi","meanings":{"general":"마차.","novel":"과거와 현재 사이의 거대한 기술적, 문화적 격차를 상징합니다. 5년간 '마차'를 타던 케빈이 현대의 자동차 운전에 어려움을 겪는 모습은, 시간 여행이 그에게 남긴 깊은 이질감과 적응의 어려움을 구체적으로 보여줍니다.","example":"Kevin tried driving—his first time after five years of horses and buggies.","translation":"케빈은 5년간의 말과 마차 생활 끝에 처음으로 운전을 시도했다."}},
        {"word":"haggard","part":"adj","pronunciation":"ˈhæɡərd","meanings":{"general":"퀭한, 수척한.","novel":"앨리스의 죽음이 루퍼스에게 미친 파괴적인 영향을 시각적으로 보여줍니다. 그의 '수척한' 모습은 깊은 슬픔과 죄책감으로 인해 육체적, 정신적으로 피폐해졌음을 드러내며, 그의 자기 파괴적인 상태를 암시합니다.","example":"He looked haggard and weary...","translation":"그는 퀭하고 지쳐 보였다..."}},
        {"word":"prerogative","part":"n","pronunciation":"prɪˈrɑːɡətɪv","meanings":{"general":"특권, 특혜.","novel":"데이나와 앨리스 사이의 복잡하고 애증이 섞인 관계를 아이러니하게 표현합니다. 데이나는 자신을 모욕하는 것이 오직 앨리스만의 '특권'이라고 생각하며, 이는 다른 사람은 침범할 수 없는, 공유된 고통 속에서 형성된 그들만의 독특한 유대감을 보여줍니다.","example":"Insulting me was her prerogative.","translation":"나를 모욕하는 것은 그녀의 특권이었다."}},
        {"word":"fondle","part":"v","pronunciation":"ˈfɑːndl","meanings":{"general":"사랑스럽게 쓰다듬다, 만지작거리다.","novel":"죽음에 대한 루퍼스의 병적인 집착과 자기 파괴적인 충동을 섬뜩하게 묘사합니다. 그가 권총을 '만지작거리는' 모습은, 절망 속에서 죽음을 유일한 위안이나 탈출구로 여기는 그의 위험한 심리 상태를 드러냅니다.","example":"I found Rufus at his desk in the library fondling a hand gun.","translation":"나는 도서관의 책상에서 루퍼스가 권총을 만지작거리고 있는 것을 발견했다."}},
        {"word":"listlessly","part":"adv","pronunciation":"ˈlɪstləsli","meanings":{"general":"힘없이, 무기력하게. (파생어: listless (adj.) 무기력한, listlessness (n.) 무기력함)","novel":"앨리스의 죽음 이후 모든 삶의 의지를 상실한 루퍼스의 상태를 보여줍니다. 그가 '무기력하게' 고개를 끄덕이는 모습은, 깊은 절망에 빠져 어떤 것에도 흥미나 감정을 느끼지 못하는 그의 공허한 내면을 드러냅니다.","example":"He nodded listlessly.","translation":"그는 무기력하게 고개를 끄덕였다."}},
        {"word":"traitor","part":"n","pronunciation":"ˈtreɪtər","meanings":{"general":"배신자, 반역자. (파생어: traitorous (adj.) 배반하는)","novel":"데이나가 느끼는 깊은 도덕적 딜레마와 죄책감을 나타냅니다. 자신의 생존을 위해 압제자인 루퍼스를 구해야만 하는 상황에서, 그녀는 다른 노예들을 '배신'하는 것 같은 기분을 느낍니다. 이는 생존과 연대 사이에서 겪는 그녀의 고통스러운 내적 갈등을 보여줍니다.","example":"I was beginning to feel like a traitor.","translation":"나는 배신자가 된 것 같은 기분이 들기 시작했다."}},
        {"word":"oblique","part":"adj","pronunciation":"oʊˈbliːk","meanings":{"general":"비스듬한, 간접적인, 완곡한. (파생어: obliquely (adv.) 간접적으로)","novel":"자신의 잘못을 직접 인정하지 못하는 루퍼스의 미성숙함과 자존심을 보여줍니다. 그가 항상 선물과 같은 '간접적인' 방식으로 사과하는 것은, 자신의 잘못을 알면서도 주인으로서의 권위를 내려놓지 못하는 그의 한계를 드러냅니다.","example":"...but his apologies had always been oblique...","translation":"...하지만 그의 사과는 항상 간접적이었다..."}},
        {"word":"uncomprehending","part":"adj","pronunciation":"ˌʌnˌkɑːmprɪˈhendɪŋ","meanings":{"general":"이해하지 못하는. (파생어: comprehend (v.) 이해하다, comprehension (n.) 이해)","novel":"자신이 저지른 잘못의 심각성을 전혀 이해하지 못하는 루퍼스의 자기중심적인 태도를 강조합니다. 데이나가 자신을 용서하지 않을 수도 있다는 가능성 자체를 '이해하지 못하는' 그의 모습은, 모든 것을 용서받는 것에 익숙해진 특권 계급의 오만함을 보여줍니다.","example":"He would have been amazed, uncomprehending if I refused to forgive him.","translation":"만약 내가 그를 용서하기를 거부했다면, 그는 놀라며 이해하지 못했을 것이다."}}
    ],
            "Epilogue": []
        };

    // ====== 전역 상태/DOM ======
    const contentArea = document.getElementById('content-area');
    const navTabs = document.querySelectorAll('.nav-tab');
    const modal = document.getElementById('word-modal');
    const modalContent = document.getElementById('modal-content');

    let rankings = [];        // Top 10 캐시
    let bookmarks = [];       // 북마크 로컬
    let isTop10 = false;      // (사용 여부 유지)

    // ====== 템플릿 ======
    const templates = {
      home: `
        <div class="bg-white p-8 rounded-xl shadow-lg text-center">
          <h2 class="text-3xl font-bold mb-4 text-indigo-600">학습을 시작하세요</h2>
          <p class="text-slate-600 mb-6 max-w-2xl mx-auto">이 단어장은 소설 '킨드레드'에 등장하는 핵심 어휘들을 깊이 있게 이해할 수 있도록 돕기 위해 만들어졌습니다.</p>
          <div class="flex flex-wrap justify-center gap-4">
            <button data-tab="vocabCards" class="nav-tab-link bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors">단어카드</button>
            <button data-tab="flashcards" class="nav-tab-link bg-teal-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-teal-700 transition-colors">플래시카드</button>
          </div>
        </div>
      `,
      vocabCards() {
        const chapters = Object.keys(vocabData);
        return `
          <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
              <h2 class="text-3xl font-bold text-indigo-600">단어</h2>
              <div class="flex items-center gap-4 w-full md:w-auto">
                <select id="chapter-select" class="p-2 border border-slate-300 rounded-md bg-white w-full md:w-48">
                  <option value="all">모든 챕터</option>
                  ${chapters.map(c=>`<option value="${c}">${c}</option>`).join('')}
                </select>
                <input type="text" id="search-input" placeholder="단어 검색..." class="p-2 border border-slate-300 rounded-md w-full md:w-48">
              </div>
            </div>
            <div id="quiz-prompt-area" class="text-center my-6"></div>
            <div id="vocab-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
          </div>
        `;
      },
      flashcards() {
        const chapters = Object.keys(vocabData);
        return `
          <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
              <h2 class="text-3xl font-bold text-indigo-600">플래시카드</h2>
              <select id="flashcard-chapter-select" class="p-2 border border-slate-300 rounded-md bg-white w-full md:w-48">
                <option value="">챕터 선택</option>
                ${chapters.map(c=>`<option value="${c}">${c}</option>`).join('')}
              </select>
            </div>
            <div id="flashcard-area" class="flex flex-col items-center justify-center min-h-[400px]"></div>
          </div>
        `;
      },
      bookmarks: `
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
          <h2 class="text-3xl font-bold text-indigo-600 mb-6">북마크한 단어</h2>
          <div id="bookmark-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
        </div>
      `,
      vocabTable: `
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
          <h2 class="text-3xl font-bold text-indigo-600 mb-6">단어목록</h2>
          <input type="text" id="table-search-input" placeholder="단어 검색..." class="p-2 border border-slate-300 rounded-md w-full mb-6">
          <div class="overflow-x-auto">
            <table class="w-full text-left">
              <thead class="border-b-2 border-slate-200 bg-slate-50">
                <tr>
                  <th class="p-4">WORD</th>
                  <th class="p-4">PART OF SPEECH</th>
                  <th class="p-4 hidden md:table-cell">일반적 의미</th>
                  <th class="p-4 text-center">ACTIONS</th>
                </tr>
              </thead>
              <tbody id="vocab-table-body"></tbody>
            </table>
          </div>
        </div>
      `,
      quiz() {
        return `
          <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
            <div id="quiz-container">
              <div id="quiz-selection" class="text-center">
                <h2 class="text-3xl font-bold text-indigo-600 mb-4">단어 퀴즈</h2>
                <p class="text-slate-600 mb-8">아래에서 퀴즈를 선택하여 학습한 단어를 확인해 보세요.</p>
                <div class="flex flex-wrap justify-center gap-4">
                  <button data-chapter="all" class="quiz-start-btn bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-colors">종합 퀴즈 시작</button>
                </div>
                <div class="mt-6 border-t pt-6">
                  <h3 class="text-xl font-semibold text-slate-700 mb-4">챕터별 퀴즈</h3>
                  <div class="flex flex-wrap justify-center gap-2">
                    ${Object.keys(vocabData).map(ch=>`<button data-chapter="${ch}" class="quiz-start-btn bg-slate-200 text-slate-700 font-semibold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors">${ch}</button>`).join('')}
                  </div>
                </div>
              </div>
              <div id="quiz-content" class="text-left hidden"></div>
            </div>
          </div>
        `;
      },
      game: `
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
          <h2 class="text-3xl font-bold text-indigo-600 mb-6 text-center">🎮 타이핑 게임</h2>
          <div class="text-center mb-6">
            <p class="text-slate-600 mb-4">떨어지는 단어를 타이핑하여 점수를 얻으세요!</p>
            
            <button id="start-game" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-colors">게임 시작</button>
          </div>
          <div class="text-center">
            <canvas id="game-canvas" class="mx-auto"></canvas>
            
<div class="mt-4">
              <input type="text" id="typing-input" placeholder="여기에 단어를 입력하세요" class="p-3 border-2 border-slate-300 rounded-lg w-full md:w-1/2 text-center text-xl" disabled>
            </div>
            <div class="mt-3 flex justify-center gap-6 text-slate-700 text-lg" id="game-hud">
              <div>Score: <span id="score">0</span></div>
              <div>Lives: <span id="lives">5</span></div>
            </div>

            <div class="mt-6 text-center">
              <p class="text-slate-600 mb-2">현재 최고 기록</p>
              <div id="current-top-score" class="text-2xl font-bold text-indigo-600">-</div>
            </div>
          </div>
        </div>
      `,
      ranking: `
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
          <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
            <h2 class="text-3xl font-bold text-indigo-600">🏆 타이핑 게임 랭킹</h2>
            <div class="flex gap-2">
              <button id="refresh-rankings" class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors">새로고침</button>
            </div>
          </div>
          <div id="rankings-list" class="space-y-3">
            <div class="text-center py-8">
              <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"></div>
              <p class="text-slate-600 mt-4">랭킹을 불러오는 중...</p>
            </div>
          </div>
        </div>
      `
    };

    // ==== 즐겨찾기 ====
    function loadBookmarks(){
      const saved = localStorage.getItem('kindredBookmarks');
      bookmarks = saved ? JSON.parse(saved) : [];
    }
    function saveBookmarks(){ localStorage.setItem('kindredBookmarks', JSON.stringify(bookmarks)); }
    function toggleBookmark(word){
      const i = bookmarks.indexOf(word);
      if (i>-1) bookmarks.splice(i,1); else bookmarks.push(word);
      saveBookmarks();
      const currentTab = document.querySelector('.tab-active').dataset.tab;
      if (currentTab==='bookmarks') renderBookmarksPage();
      else document.querySelectorAll(`.bookmark-icon[data-word="${word}"]`).forEach(el=>el.classList.toggle('bookmarked'));
    }

    function speak(word){
      if ('speechSynthesis' in window) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(word);
        u.lang = 'en-US'; window.speechSynthesis.speak(u);
      } else { alert('음성 지원이 되지 않는 브라우저입니다.'); }
    }

    // ==== 카드/모달 ====
    function createWordCard(word){
      const card = document.createElement('div');
      const isBookmarked = bookmarks.includes(word.word);
      card.className = 'flex flex-col justify-between p-5 bg-white rounded-lg border border-slate-200 shadow-sm cursor-pointer hover:shadow-lg hover:border-indigo-400 transition-all min-h-[140px]';
      card.innerHTML = `
        <div class="w-full">
          <p class="text-lg font-bold text-indigo-700">${word.word}</p>
          <p class="text-slate-500 text-sm">${word.part} / ${word.pronunciation||''}</p>
        </div>
        <div class="flex justify-end items-center mt-4 gap-2 w-full">
          <button class="speak-icon text-slate-400 hover:text-indigo-600" data-word="${word.word}" title="발음 듣기">🔊</button>
          <button class="bookmark-icon text-slate-400 hover:text-amber-500 ${isBookmarked?'bookmarked':''}" data-word="${word.word}" title="북마크">★</button>
        </div>
      `;
      card.addEventListener('click', (e)=>{
        if (!e.target.closest('button')) openWordModal(word);
      });
      return card;
    }

    function openWordModal(wordData){
      const isBookmarked = bookmarks.includes(wordData.word);
      modalContent.innerHTML = `
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-3xl font-bold text-indigo-700 mb-2">${wordData.word}</h3>
            <p class="text-slate-500 mb-6">${wordData.part} / ${wordData.pronunciation||''}</p>
          </div>
          <div class="flex items-center gap-3">
            <button class="speak-icon text-slate-400 hover:text-indigo-600" data-word="${wordData.word}">🔊</button>
            <button class="bookmark-icon text-slate-400 hover:text-amber-500 ${isBookmarked?'bookmarked':''}" data-word="${wordData.word}">★</button>
            <button id="close-modal-inner" class="text-slate-500 hover:text-slate-800 text-3xl font-bold">&times;</button>
          </div>
        </div>
        <div class="space-y-4 text-left max-h-[60vh] overflow-y-auto pr-4 mt-4">
          <div>
            <h4 class="font-bold text-lg text-teal-700 border-b-2 border-teal-200 pb-1 mb-2">일반적 의미</h4>
            <p>${wordData.meanings.general}</p>
          </div>
          ${wordData.meanings.novel ? `
          <div>
            <h4 class="font-bold text-lg text-teal-700 border-b-2 border-teal-200 pb-1 mb-2">소설 속 의미</h4>
            <p>${wordData.meanings.novel}</p>
          </div>`:''}
          <div>
            <h4 class="font-bold text-lg text-teal-700 border-b-2 border-teal-200 pb-1 mb-2">소설 속 예제</h4>
            <p class="bg-slate-100 p-4 rounded-md">
              <em class="italic">"${wordData.meanings.example||''}"</em>
              <br>
              <span class="text-slate-600 text-sm mt-2 block">(${wordData.meanings.translation||''})</span>
            </p>
          </div>
        </div>
      `;
      modal.classList.remove('hidden');
      setTimeout(()=>{ modal.style.opacity=1; modalContent.style.transform='scale(1)'; },10);
      document.getElementById('close-modal-inner').addEventListener('click', closeWordModal);
    }
    function closeWordModal(){
      modal.style.opacity=0; modalContent.style.transform='scale(0.95)'; setTimeout(()=>modal.classList.add('hidden'),300);
    }

    // ====== 렌더링 ======
    const templatesRenderers = {

      setupGuestbook(){
        const form = document.getElementById("guestbook-form");
        const authorEl = document.getElementById("guestbook-author");
        const textEl = document.getElementById("guestbook-text");
        const sortEl = document.getElementById("guestbook-sort");
        const listEl = document.getElementById("guestbook-list");

        let unsub = null;
        const resubscribe = () => {
          if (unsub) unsub();
          const [field, dir] = sortEl.value.split(":");
          unsub = GuestbookAPI.subscribe({ orderByField: field, direction: dir }, (items) => {
            if (!items.length) {
              listEl.innerHTML = `<p class="text-center text-slate-500 py-10">아직 방명록이 없습니다. 첫 글을 남겨보세요!</p>`;
              return;
            }
            listEl.innerHTML = items.map(item => {
              const isMine = (item.uid && auth.currentUser && item.uid === auth.currentUser.uid);
              return `
              <div class="rounded-xl border border-slate-200 p-4 bg-slate-50">
                <div class="flex justify-between items-center mb-2">
                  <div class="font-semibold text-indigo-700">${(item.author||"익명").replace(/</g,"&lt;")}${isMine? ' <span class="ml-1 text-xs text-slate-400">(내 글)</span>': ''}</div>
                  <div class="text-xs text-slate-500">${item.createdAt?.toDate ? item.createdAt.toDate().toLocaleString() : new Date(item.createdAt||Date.now()).toLocaleString()}</div>
                </div>
                <p class="text-slate-700 whitespace-pre-wrap">${(item.text||"").replace(/</g,"&lt;")}</p>
                <div class="flex gap-3 mt-3">
                  <button ${isMine? 'disabled title="본인 글 투표 불가"' : ''} data-id="${item.id}" data-type="like" class="gb-like inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-white disabled:opacity-40 disabled:cursor-not-allowed">
                    👍 <span>${item.likeCount||0}</span>
                  </button>
                  <button ${isMine? 'disabled title="본인 글 투표 불가"' : ''} data-id="${item.id}" data-type="dislike" class="gb-dislike inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border hover:bg-white disabled:opacity-40 disabled:cursor-not-allowed">
                    👎 <span>${item.dislikeCount||0}</span>
                  </button>
                </div>
              </div>`;
            }).join("");

            listEl.querySelectorAll(".gb-like,.gb-dislike").forEach(btn => {
              btn.addEventListener("click", async (e) => {
                const id = e.currentTarget.getAttribute("data-id");
                const type = e.currentTarget.getAttribute("data-type");
                const res = await GuestbookAPI.vote({ id, type });
                if (res?.reason) alert(res.reason);
              });
            });
          });
        };

        sortEl.addEventListener("change", resubscribe);
        resubscribe();

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          const author = authorEl.value.trim();
          const text = textEl.value.trim();
          try {
            await GuestbookAPI.addEntry({ author, text });
            textEl.value = "";
          } catch (err) {
            alert(err.message || "등록에 실패했습니다");
          }
        });
      },

      setupVocabCardsPage(){
        renderVocabCards();
        document.getElementById('chapter-select').addEventListener('change', (e)=>renderVocabCards(e.target.value, document.getElementById('search-input').value));
        document.getElementById('search-input').addEventListener('input', (e)=>renderVocabCards(document.getElementById('chapter-select').value, e.target.value));
      },
      setupVocabTablePage(){
        renderVocabTable();
        document.getElementById('table-search-input').addEventListener('input', (e)=>renderVocabTable(e.target.value));
      },
      setupBookmarks(){ renderBookmarksPage(); },
      setupQuiz(){ setupQuizPage(); },
      async setupGame(){
        setupGamePage();
      },
      async setupRanking(){
        await loadRankings();
        renderRankingPage();
        const btn = document.getElementById('refresh-rankings');
        btn?.addEventListener('click', async ()=>{
          await loadRankings();
          renderRankingPage();
        });
      }
    };

    function render(view){
      contentArea.innerHTML = typeof templates[view]==='function' ? templates[view]() : templates[view];
      navTabs.forEach(t=>t.classList.remove('tab-active'));
      document.querySelector(`[data-tab="${view}"]`).classList.add('tab-active');

      if (view==='vocabCards') templatesRenderers.setupVocabCardsPage();
      else if (view==='vocabTable') templatesRenderers.setupVocabTablePage();
      else if (view==='bookmarks') templatesRenderers.setupBookmarks();
      else if (view==='quiz') templatesRenderers.setupQuiz();
      else if (view==='game') templatesRenderers.setupGame();
      else if (view==='flashcards') setupFlashcardsPage();
      else if (view==='ranking') templatesRenderers.setupRanking();
      else if (view==='guestbook') templatesRenderers.setupGuestbook();
    }

    // ====== 페이지별 동작 ======
    function renderVocabCards(chapter='all', searchTerm=''){
      const list = document.getElementById('vocab-list');
      const prompt = document.getElementById('quiz-prompt-area');
      if (!list || !prompt) return;

      list.innerHTML='';
      let words = (chapter==='all'?Object.values(vocabData).flat(): (vocabData[chapter]||[]))
        .filter(w=>w.word.toLowerCase().includes(searchTerm.toLowerCase()));
      prompt.innerHTML = (chapter!=='all' && words.length>0)
        ? `<button id="start-chapter-quiz" data-chapter="${chapter}" class="bg-teal-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-teal-600 transition-colors">${chapter} 퀴즈 풀기</button>`
        : '';

      if (!words.length) {
        list.innerHTML = `<p class="text-slate-500 col-span-full text-center py-10">해당하는 단어가 없습니다.</p>`;
        return;
      }
      words.forEach(w=>list.appendChild(createWordCard(w)));
    }

    function renderBookmarksPage(){
      const container = document.getElementById('bookmark-list');
      if (!container) return;
      container.innerHTML='';
      const all = Object.values(vocabData).flat();
      const items = all.filter(w=>bookmarks.includes(w.word));
      if (!items.length){
        container.innerHTML = `<p class="text-slate-500 col-span-full text-center py-10">북마크한 단어가 없습니다.</p>`;
        return;
      }
      items.forEach(w=>container.appendChild(createWordCard(w)));
    }

    function renderVocabTable(searchTerm=''){
      const body = document.getElementById('vocab-table-body');
      if (!body) return;
      const all = Object.values(vocabData).flat();
      const filtered = searchTerm
        ? all.filter(i => i.word.toLowerCase().includes(searchTerm.toLowerCase()) || (i.meanings.general||'').toLowerCase().includes(searchTerm.toLowerCase()))
        : all;
      body.innerHTML = filtered.map(i=>`
        <tr class="hover:bg-slate-50">
          <td class="p-4">${i.word}</td>
          <td class="p-4">${i.part}</td>
          <td class="p-4 hidden md:table-cell">${(i.meanings.general||'').slice(0,50)}...</td>
          <td class="p-4 text-center">
            <button class="bookmark-icon ${bookmarks.includes(i.word)?'bookmarked':''}" data-word="${i.word}">${bookmarks.includes(i.word)?'★':'☆'}</button>
          </td>
        </tr>
      `).join('');
    }

    // ==== 랭킹 ====
    async function loadRankings(){
      rankings = await RankingsAPI.loadTop10();
      updateTopScoreDisplay();
    }
    function renderRankingPage(){
      const el = document.getElementById('rankings-list');
      if (!el) return;
      if (!rankings.length){
        el.innerHTML = `
          <div class="text-center py-10">
            <p class="text-slate-500 text-lg">아직 기록된 점수가 없습니다.</p>
            <p class="text-slate-400 mt-2">타이핑 게임을 플레이하여 첫 번째 기록을 만들어보세요!</p>
          </div>`;
        return;
      }
      el.innerHTML = rankings.map((r,idx)=>{
        const rankClass = idx<3 ? `rank-${idx+1}` : 'bg-white';
        const icon = idx<3 ? ['🥇','🥈','🥉'][idx] : `${idx+1}`;
        return `
          <div class="ranking-item ${rankClass} p-4 rounded-lg border border-slate-200 shadow-sm">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="text-2xl font-bold ${idx<3?'text-white':'text-indigo-600'}">${icon}</div>
                <div>
                  <div class="font-bold text-lg ${idx<3?'text-white':'text-slate-800'}">${r.nickname}</div>
                  <div class="text-sm ${idx<3?'text-white/90':'text-slate-500'}">${r.date}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="text-3xl font-bold ${idx<3?'text-white':'text-indigo-600'}">${r.score}</div>
                <div class="text-sm ${idx<3?'text-white/90':'text-slate-500'}">점수</div>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }
    function updateTopScoreDisplay(){
      const top = document.getElementById('current-top-score');
      if (top) top.textContent = rankings.length ? rankings[0].score : '-';
    }

    // ==== 퀴즈 ====
    function startQuiz(container, chapter='all'){
      const sel = document.getElementById('quiz-selection');
      const content = document.getElementById('quiz-content');
      sel?.classList.add('hidden'); content?.classList.remove('hidden');
      const all = Object.values(vocabData).flat();
      const pool = chapter==='all'? all : vocabData[chapter];
      let idx=0, score=0, qs=[];

      const title = chapter==='all' ? '종합 단어 퀴즈' : `${chapter} 퀴즈`;
      content.innerHTML = `<h2 class="text-3xl font-bold text-indigo-600 mb-4 text-center">${title}</h2><div id="quiz-inner-content"></div>`;
      const inner = document.getElementById('quiz-inner-content');

      const shuffled = [...pool].sort(()=>0.5-Math.random());
      const simple = s => (typeof s==='string'? s.replace(/\s*\(.*\)\s*/g,'').split('.')[0].trim() : '');

      for (let i=0;i<Math.min(10,shuffled.length);i++){
        const w = shuffled[i];
        const type = Math.random()<0.5 ? 'defToWord' : 'wordToDef';
        let qText, correct, opts=[];
        const m = simple(w.meanings.general);
        if (!m) continue;
        if (type==='defToWord'){
          qText = `다음 뜻을 가진 단어는?<br><strong class="text-indigo-600 text-lg mt-2 block">"${m}"</strong>`;
          correct = w.word; opts.push(correct);
          let others = all.filter(x=>x.word!==correct);
          while (opts.length<4 && others.length){
            const r = others.splice(Math.floor(Math.random()*others.length),1)[0];
            if (r) opts.push(r.word);
          }
        } else {
          qText = `다음 단어의 뜻으로 알맞은 것은?<br><strong class="text-indigo-600 text-lg mt-2 block">"${w.word}"</strong>`;
          correct = m; opts.push(correct);
          let others = all.filter(x=>x.word!==w.word);
          while (opts.length<4 && others.length){
            const r = others.splice(Math.floor(Math.random()*others.length),1)[0];
            if (r && r.meanings?.general){
              const mm = simple(r.meanings.general);
              if (mm && !opts.includes(mm)) opts.push(mm);
            }
          }
        }
        if (opts.length<2) continue;
        opts.sort(()=>0.5-Math.random());
        qs.push({questionText:qText, options:opts, correctAnswer:correct});
      }

      function showQ(){
        if (idx>=qs.length) return showResult();
        const q=qs[idx];
        inner.innerHTML = `
          <div class="p-4 border-l-4 border-indigo-500 bg-indigo-50 mb-6 text-left">
            <p class="font-semibold text-lg">질문 ${idx+1}/${qs.length}</p>
            <p class="text-slate-700 mt-1">${q.questionText}</p>
          </div>
          <div class="space-y-3 text-left">
            ${q.options.map(opt=>`<div class="quiz-option border-2 border-slate-300 p-3 rounded-lg cursor-pointer hover:bg-indigo-100">${opt}</div>`).join('')}
          </div>
          <div id="feedback" class="mt-4 text-center h-6"></div>
          <div class="text-center mt-6">
            <button id="next-q-btn" class="bg-gray-400 text-white font-bold py-2 px-6 rounded-lg cursor-not-allowed" disabled>다음 문제</button>
          </div>`;
        const opts = inner.querySelectorAll('.quiz-option');
        let answered=false;
        opts.forEach(el=>{
          el.addEventListener('click',()=>{
            if (answered) return;
            answered=true;
            const ok = el.textContent===q.correctAnswer;
            if (ok){ score += 10; el.classList.add('correct'); inner.querySelector('#feedback').innerHTML=`<p class="text-green-600 font-bold">정답입니다!</p>`; }
            else{
              el.classList.add('incorrect');
              inner.querySelector('#feedback').innerHTML=`<p class="text-red-600 font-bold">오답입니다. 정답: '${q.correctAnswer}'</p>`;
              opts.forEach(o=>{ if (o.textContent===q.correctAnswer) o.classList.add('correct'); });
            }
            const next = document.getElementById('next-q-btn');
            next.disabled=false; next.classList.remove('bg-gray-400','cursor-not-allowed'); next.classList.add('bg-indigo-600','hover:bg-indigo-700');
          });
        });
        document.getElementById('next-q-btn').addEventListener('click',()=>{ idx++; showQ(); });
      }
      function showResult(){
        inner.innerHTML = `
          <h3 class="text-2xl font-bold text-center mb-4">퀴즈 결과</h3>
          <p class="text-4xl font-bold text-center text-indigo-600 mb-6">${score} / ${qs.length}</p>
          <p class="text-center text-slate-600">${(score/qs.length)>=0.8?'훌륭해요!':'조금 더 연습해볼까요?'}</p>
          <div class="text-center mt-8">
            <button id="retry-quiz-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-colors">다른 문제 풀기</button>
          </div>`;
        document.getElementById('retry-quiz-btn').addEventListener('click',()=>startQuiz(container,chapter));
      }
      showQ();
    }
    function setupQuizPage(){
      const wrap = document.getElementById('quiz-container');
      wrap.addEventListener('click',(e)=>{
        if (e.target.classList.contains('quiz-start-btn')) startQuiz(wrap, e.target.dataset.chapter);
      });
    }

    // ==== 게임 ====
    function showScoreInputModal(score){
      document.getElementById('final-score').textContent = score;
      document.getElementById('score-modal').classList.remove('hidden');
      document.getElementById('nickname-input').focus();
    }
    function hideScoreInputModal(){
      document.getElementById('score-modal').classList.add('hidden');
      document.getElementById('nickname-input').value='';
    }
    function checkTop10(score){
      if (rankings.length<10) return true;
      return score > rankings[rankings.length-1].score;
    }

    const MAX_WORDS_ON_SCREEN = 8; // 🔧 동시에 화면에 보일 수 있는 단어 최대 개수
    const MIN_SPAWN_GAP_X = 12;    // 단어들 사이 최소 가로 여유(px)
    const TOP_COLLISION_BAND = 64; // y가 이 범위(상단 밴드) 안에 있는 단어들과만 충돌 검사
    const WORD_LINE_HEIGHT = 38;   // 영어(20) + 간격 + 한글(16) 대략 총 높이
    const MAX_SPAWN_TRIES = 12;    // 겹치면 좌표 재시도 횟수


    function setupGamePage(){
      const canvas=document.getElementById('game-canvas');
      const ctx=canvas.getContext('2d');
      const typingInput=document.getElementById('typing-input');
      const startButton=document.getElementById('start-game');
      const scoreEl=document.getElementById('score');
      const livesEl=document.getElementById('lives');
      if (!canvas||!ctx||!typingInput||!startButton) return;

        // 단어 -> 간단 한국어 의미 매핑
        const meaningMap = new Map();
        (function buildMeaningMap(){
        const all = Object.values(vocabData).flat();
        const simpleMeaning = (s) => {
            if (typeof s !== 'string') return '';
            // 괄호 설명 제거 후, 첫 문장만
            return s.replace(/\s*\(.*?\)\s*/g, '').split(/[.;]/)[0].trim();
        };
        for (const item of all) {
            if (item?.word && item?.meanings?.general) {
            meaningMap.set(item.word, simpleMeaning(item.meanings.general));
            }
        }
        })();

      function renderScore() {
        const margin = 12;
        ctx.save();
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 22px "Noto Sans KR", sans-serif';
        ctx.textBaseline = 'top';
        ctx.fillText(`Score: ${score}`, margin, margin);
        ctx.restore();
      }

      function renderLives() {
        const margin = 12;        // 우측/상단 여백
        const size   = 22;        // 하트 크기(px)
        const gap    = 6;         // 하트 간격
        const heart  = '\u2764\uFE0F'; // ❤️ (VS16 포함)

        const ctx = canvas.getContext('2d');
        ctx.save();
        ctx.textBaseline = 'top';
        ctx.fillStyle    = '#ef4444';
        ctx.font = `${size}px "Segoe UI Emoji","Apple Color Emoji","Noto Color Emoji","Noto Sans KR",sans-serif`;

        // ★ 여기서 CSS 폭으로 환산해서 사용 (DPR 보정)
        const scaleX   = (ctx.getTransform && ctx.getTransform().a) || (window.devicePixelRatio || 1);
        const cssWidth = Math.round(canvas.width / scaleX);

        for (let i = 0; i < lives; i++) {
          const x = cssWidth - margin - (i + 1) * size - i * gap; // ← canvas.width 대신 cssWidth
          const y = margin;
          ctx.fillText(heart, x, y);
        }
        ctx.restore();
      }

      let gameActive=false, score=0, lives=5, words=[], spawnTimer=null, animId=null;
      const allWords = Object.values(vocabData).flat().map(w=>w.word);

      function resizeCanvas(){
        const w = Math.min(canvas.parentElement.clientWidth-32, 800);
        canvas.width = w; canvas.height = Math.max(320, Math.floor(w*(5/8)));
      }
      resizeCanvas(); window.addEventListener('resize', resizeCanvas);
      updateTopScoreDisplay();

      const WORD_SPEED = 0.3; // 🔹모든 단어가 동일하게 떨어지는 속도(더 느리게). 필요시 0.6~1.0 사이로 조절.

    //   function spawnWord(){
    //     if (!gameActive||!allWords.length) return;
        
    //     // 👉 화면 상 최대 단어 개수 제한
    //     if (words.length >= MAX_WORDS_ON_SCREEN) return;

    //     const text = allWords[Math.floor(Math.random()*allWords.length)];
    //     // ctx.font='20px Noto Sans KR, sans-serif';
    //     // const tw = ctx.measureText(text).width||80;
    //     // const pad=20, x = Math.floor(Math.random()*(canvas.width - tw - pad*2))+pad;

    //     // const speedBase = 1.2 + Math.min(score/20, 4);
    //     // const speed = speedBase + Math.random()*1.5;
    //     // words.push({text,x,y:-10,speed});
    //      const mean = meaningMap.get(text) || '';
    //       const pad = 20;

    //       // 두 줄 중 더 긴 폭으로 배치
    //       ctx.font = '20px Noto Sans KR, sans-serif';
    //       const wEng = ctx.measureText(text).width;
    //      ctx.font = '16px Noto Sans KR, sans-serif';
    //       const wKor = ctx.measureText(mean).width;
    //       const lineWidth = Math.max(wEng, wKor, 80);
    //       const x = Math.floor(Math.random() * Math.max(1, (canvas.width - lineWidth - pad*2))) + pad;


    //     // const speed = WORD_SPEED;
    //     // words.push({ text, x, y:-10, speed });
    //       const speed = WORD_SPEED;
    //       words.push({ text, meaning: mean, x, y: -10, speed });
    //   }
    function spawnWord() {
        if (!gameActive || !allWords.length) return;
        if (words.length >= MAX_WORDS_ON_SCREEN) return; // 화면 최대 개수 제한

        const text = allWords[Math.floor(Math.random() * allWords.length)];
        const mean = meaningMap.get(text) || '';
        const pad = 20;

        // 두 줄 중 더 긴 폭으로 폭 계산
        ctx.font = '20px Noto Sans KR, sans-serif';
        const wEng = ctx.measureText(text).width;
        ctx.font = '16px Noto Sans KR, sans-serif';
        const wKor = ctx.measureText(mean).width;
        const lineWidth = Math.max(wEng, wKor, 80);
        const height = mean ? WORD_LINE_HEIGHT : 24;

        // 기존 단어들과 겹치지 않도록 여러 번 시도
        let x = 0;
        let y = -10; // 스폰 시작 y
        let ok = false;

        for (let tries = 0; tries < MAX_SPAWN_TRIES; tries++) {
            x = Math.floor(
            Math.random() * Math.max(1, (canvas.width - lineWidth - pad * 2))
            ) + pad;

            // 새 박스(상단 밴드 내)와 기존 단어들 박스가 겹치는지 확인
            const newBox = { x, y, w: lineWidth, h: height };

            const overlap = words.some((w) => {
            // 상단 밴드에 있는 단어만 검사(막 스폰된 단어들 위주)
            if (w.y > TOP_COLLISION_BAND) return false;
            const otherBox = { x: w.x, y: w.y, w: w.width || lineWidth, h: w.height || height };

            // 마진을 둔 AABB 충돌
            const gx = MIN_SPAWN_GAP_X;
            const gy = 6;
            const noOverlap =
                newBox.x + newBox.w + gx < otherBox.x ||
                otherBox.x + otherBox.w + gx < newBox.x ||
                newBox.y + newBox.h + gy < otherBox.y ||
                otherBox.y + otherBox.h + gy < newBox.y;

            return !noOverlap;
            });

            if (!overlap) { ok = true; break; }
        }

        if (!ok) {
            // 이번 스폰은 건너뜀 — 다음 틱에 다시 시도
            return;
        }

        const speed = WORD_SPEED; // 고정 속도 유지
        words.push({ text, meaning: mean, x, y, speed, width: lineWidth, height });
        }

      function draw(){
        if (!gameActive) return;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.font='20px Noto Sans KR, sans-serif';
        ctx.textBaseline='top';
        for (let i=words.length-1;i>=0;i--){
          const w=words[i]; w.y+=w.speed; 
        //   ctx.fillStyle='#fff'; ctx.fillText(w.text,w.x,w.y);

         // 영어
        ctx.font = '20px Noto Sans KR, sans-serif';
        ctx.fillStyle = '#ffffff';
        ctx.fillText(w.text, w.x, w.y);
        // 한글 뜻 (영어 아래 22px 위치, 약간 옅은 흰색)
        if (w.meaning) {
            ctx.font = '16px Noto Sans KR, sans-serif';
            ctx.fillStyle = 'rgba(255,255,255,0.85)';
            ctx.shadowColor = 'rgba(0,0,0,0.6)';
            ctx.shadowBlur = 2;
            ctx.fillText(w.meaning, w.x, w.y + 22);
        }

        //   if (w.y>canvas.height-24){
        // 두 줄 높이 고려(영어20 + 간격2 + 한글16 ~= 38)
        // const bottomY = w.meaning ? (w.y + 38) : (w.y + 24);
        const bottomY = w.y + (w.height || (w.meaning ? WORD_LINE_HEIGHT : 24));
        if(bottomY > canvas.height){
            words.splice(i,1); lives-=1; if (livesEl) livesEl.textContent=lives;
            if (lives<=0){ endGame(); return; }
          }
        }

        // 🔹좌측 상단 점수
        renderScore();

        // 🔸최상단에 하트 렌더
        renderLives();
        animId = requestAnimationFrame(draw);
      }

      function handleInput(e){
        if (!gameActive) return;
        const val = typingInput.value.trim();
        if (e.key==='Enter' && val.length>0){
          let matched=-1, maxY=-Infinity;
          for (let i=0;i<words.length;i++){
            if (words[i].text.toLowerCase()===val.toLowerCase()){
              if (words[i].y>maxY){ maxY=words[i].y; matched=i; }
            }
          }
          if (matched!==-1){
            words.splice(matched,1);
            score+=10; if (scoreEl) scoreEl.textContent=score;
          }
          typingInput.value='';
        }
      }

      function startGame(){
        if (gameActive) return;
        gameActive=true; score=0; lives=5; words=[];
        if (scoreEl) scoreEl.textContent='0'; if (livesEl) livesEl.textContent='5';
        typingInput.disabled=false; typingInput.value=''; typingInput.focus();
        startButton.disabled=true; startButton.classList.add('opacity-60','cursor-not-allowed');
        spawnTimer && clearInterval(spawnTimer);
        spawnTimer=setInterval(spawnWord,1200); spawnWord();
        animId && cancelAnimationFrame(animId); animId=requestAnimationFrame(draw);
      }

      async function endGame(){
        gameActive=false;
        animId && cancelAnimationFrame(animId);
        spawnTimer && clearInterval(spawnTimer);
        typingInput.disabled=true;
        startButton.disabled=false; startButton.classList.remove('opacity-60','cursor-not-allowed');

        const qualifies = checkTop10(score);
        if (qualifies) showScoreInputModal(score);
        else alert(`게임 종료! 점수: ${score}`);

        await loadRankings(); // 종료 후 최신 랭킹 반영
        updateTopScoreDisplay();
      }

      startButton.addEventListener('click', startGame);
      typingInput.addEventListener('keydown', handleInput);
      document.addEventListener('visibilitychange', ()=>{ if (document.hidden && gameActive) endGame(); });
    }

    // ==== 플래시카드 ====
    function setupFlashcardsPage(){
      const sel = document.getElementById('flashcard-chapter-select');
      const area = document.getElementById('flashcard-area');
      let currentWords=[], idx=0;

      function renderUI(){
        if (!currentWords.length){ area.innerHTML=`<p class="text-slate-500">학습할 챕터를 선택하세요.</p>`; return; }
        const w = currentWords[idx];
        area.innerHTML = `
          <div class="flashcard-container w-full max-w-md h-56 sm:h-64 mb-4">
            <div class="flashcard relative w-full h-full cursor-pointer">
              <div class="flashcard-front absolute w-full h-full bg-white rounded-lg shadow-lg flex items-center justify-center p-6 border-2 border-indigo-200">
                <span class="text-3xl sm:text-4xl font-bold text-indigo-700 text-center">${w.word}</span>
              </div>
              <div class="flashcard-back absolute w-full h-full bg-indigo-100 rounded-lg shadow-lg flex flex-col items-center justify-center p-6 border-2 border-indigo-200">
                <p class="text-slate-800 text-center text-base sm:text-lg">${w.meanings.general||''}</p>
              </div>
            </div>
          </div>
          <div class="flex items-center justify-center gap-4 w-full max-w-md">
            <button id="prev-card" class="p-2 rounded-full bg-slate-200 hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed">◀</button>
            <p id="card-progress" class="text-slate-600 font-medium">${idx+1} / ${currentWords.length}</p>
            <button id="next-card" class="p-2 rounded-full bg-slate-200 hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed">▶</button>
          </div>
        `;
        document.querySelector('.flashcard').addEventListener('click',(e)=>e.currentTarget.classList.toggle('is-flipped'));
        const prev=document.getElementById('prev-card'), next=document.getElementById('next-card');
        prev.disabled = idx===0; next.disabled = idx===currentWords.length-1;
        prev.addEventListener('click',()=>{ if (idx>0){ idx--; renderUI(); } });
        next.addEventListener('click',()=>{ if (idx<currentWords.length-1){ idx++; renderUI(); } });
      }

      sel.addEventListener('change', ()=>{
        const ch = sel.value;
        if (ch && vocabData[ch]){ currentWords = vocabData[ch]; idx=0; renderUI(); }
        else { currentWords=[]; renderUI(); }
      });
      renderUI();
    }

    // ==== 공통 이벤트 바인딩 ====
    function setupCommonEvents(){
      navTabs.forEach(tab => tab.addEventListener('click', ()=>render(tab.dataset.tab)));

      contentArea.addEventListener('click', (e)=>{
        if (e.target.closest('.nav-tab-link')){
          e.preventDefault(); render(e.target.closest('.nav-tab-link').dataset.tab);
        }
        if (e.target.closest('.bookmark-icon')){
          const w = e.target.closest('.bookmark-icon').dataset.word; toggleBookmark(w);
        }
        if (e.target.closest('.speak-icon')){
          const w = e.target.closest('.speak-icon').dataset.word; speak(w);
        }
        if (e.target.closest('#start-chapter-quiz')){
          const ch = e.target.closest('#start-chapter-quiz').dataset.chapter;
          render('quiz'); setTimeout(()=>startQuiz(document.getElementById('quiz-container'), ch),0);
        }
      });

      modal.addEventListener('click',(e)=>{
        if (e.target.id==='word-modal') closeWordModal();
        if (e.target.closest('.bookmark-icon')){
          const w = e.target.closest('.bookmark-icon').dataset.word;
          toggleBookmark(w); e.target.closest('.bookmark-icon').classList.toggle('bookmarked');
        }
        if (e.target.closest('.speak-icon')){
          const w = e.target.closest('.speak-icon').dataset.word; speak(w);
        }
      });

      // 점수 저장 모달
      document.getElementById('save-score-btn').addEventListener('click', async ()=>{
        const nickname = document.getElementById('nickname-input').value.trim();
        if (!nickname) return alert('닉네임을 입력해주세요.');
        const score = parseInt(document.getElementById('final-score').textContent||'0',10);
        const ok = await RankingsAPI.saveScore(nickname, score);
        if (ok){
          hideScoreInputModal();
          await loadRankings();
          // 랭킹 탭이 열려있다면 갱신
          if (document.querySelector('[data-tab="ranking"]').classList.contains('tab-active')) renderRankingPage();
          alert('점수가 저장되었습니다!');
        } else {
          alert('점수 저장에 실패했습니다.');
        }
      });
      document.getElementById('cancel-score-btn').addEventListener('click', hideScoreInputModal);
      document.getElementById('nickname-input').addEventListener('keypress',(e)=>{ if (e.key==='Enter') document.getElementById('save-score-btn').click(); });
    }

    // ==== 초기화 ====
    document.addEventListener('DOMContentLoaded', async ()=>{
      loadBookmarks();
      render('home');
      setupCommonEvents();
      // 시작 시 랭킹 미리 로드(게임 화면의 "현재 최고 기록" 표시용)
      await loadRankings();
    });
  


// --- 방명록 API (Firestore 우선, 실패 시 로컬 폴백) ---
const GuestbookAPI = {
  colRef: collection(db, "guestbook"),

  async addEntry({ author, text }) {
    await ensureAuth(true);
    const user = auth.currentUser;
    const payload = {
      author: (author || "익명").slice(0, 24),
      text: (text || "").trim().slice(0, 1000),
      likeCount: 0,
      dislikeCount: 0,
      createdAt: serverTimestamp(),
      uid: user?.uid || null
    };
    if (!payload.text) throw new Error("내용을 입력하세요.");
    try {
      await addDoc(this.colRef, payload);
      return { ok: true };
    } catch (e) {
      console.warn("guestbook addEntry 실패:", e);
      const list = JSON.parse(localStorage.getItem("kindredGuestbook") || "[]");
      list.push({ ...payload, createdAt: Date.now(), id: "local-" + Math.random().toString(36).slice(2) });
      localStorage.setItem("kindredGuestbook", JSON.stringify(list));
      return { ok: true, local: true };
    }
  },

  // 교체용: GuestbookAPI.subscribe
subscribe({ orderByField = "createdAt", direction = "desc" }, onChange) {
    try {
      const parts = [];

      // 1차 정렬
      parts.push(orderBy(orderByField, direction));

      // 2차 정렬(동점 타이브레이커) — createdAt이 1차가 아닐 때만 추가
      if (orderByField !== "createdAt") {
        parts.push(orderBy("createdAt", "desc"));
      }

      const qRef = query(this.colRef, ...parts);
      const unsub = onSnapshot(qRef, (snap) => {
        const items = [];
        snap.forEach((d) => items.push({ id: d.id, ...d.data() }));
        onChange(items);
      });
      return unsub;
    } catch (e) {
      console.warn("guestbook subscribe 실패, 로컬 폴백:", e);
      const loadLocal = () => {
        const raw = JSON.parse(localStorage.getItem("kindredGuestbook") || "[]");
        const key = orderByField;
        const sorted = raw
          .sort((a, b) => (b[key] || 0) - (a[key] || 0) || (b.createdAt || 0) - (a.createdAt || 0));
        onChange(sorted);
      };
      loadLocal();
      return () => {};
    }
  },


  async vote({ id, type }) { // type: "like" | "dislike"
    await ensureAuth(true);
    const user = auth.currentUser;
    if (!user) throw new Error("로그인 필요");
    const entryRef = doc(db, "guestbook", id);
    const voteRef  = doc(db, "guestbook", id, "votes", user.uid);

    // 본인 글 차단
    const entrySnap = await getDoc(entryRef);
    if (entrySnap.exists() && entrySnap.data()?.uid && entrySnap.data().uid === user.uid) {
      return { ok:false, reason: "본인 글에는 투표할 수 없습니다" };
    }

    // 중복 투표 차단
    const voted = await getDoc(voteRef);
    if (voted.exists()) return { ok:false, reason: "이미 투표했습니다" };

    try {
      await updateDoc(entryRef, { [type+"Count"]: increment(1) });
      await setDoc(voteRef, { type, at: serverTimestamp() });
      return { ok:true };
    } catch (e) {
      console.warn("vote 실패:", e);
      const raw = JSON.parse(localStorage.getItem("kindredGuestbook") || "[]");
      const i = raw.findIndex(x=>x.id===id);
      if (i>-1) {
        const key = type+"Count";
        raw[i][key] = (raw[i][key]||0)+1;
        localStorage.setItem("kindredGuestbook", JSON.stringify(raw));
      }
      return { ok:true, local:true };
    }
  }
};



templates.guestbook = `
  <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
    <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
      <h2 class="text-3xl font-bold text-indigo-600">방명록</h2>
      <div class="flex items-center gap-2">
        <label for="guestbook-sort" class="text-slate-600">정렬:</label>
        <select id="guestbook-sort" class="p-2 border border-slate-300 rounded-md bg-white">
          <option value="createdAt:desc">최신순</option>
          <option value="likeCount:desc">Like순</option>
          <option value="dislikeCount:desc">DisLike순</option>
        </select>
      </div>
    </div>
    <form id="guestbook-form" class="space-y-3 mb-6">
      <div class="grid grid-cols-1 md:grid-cols-6 gap-3">
        <input id="guestbook-author" maxlength="24" placeholder="닉네임 (선택)" class="md:col-span-2 p-3 border border-slate-300 rounded-lg" />
        <textarea id="guestbook-text" rows="2" maxlength="1000" placeholder="사용 소감을 남겨주세요" class="md:col-span-4 p-3 border border-slate-300 rounded-lg"></textarea>
      </div>
      <div class="flex justify-end">
        <button class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700">등록</button>
      </div>
    </form>
    <div id="guestbook-list" class="space-y-3">
      <div class="text-center py-8">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"></div>
        <p class="text-slate-600 mt-4">불러오는 중...</p>
      </div>
    </div>
  </div>
`;

// ===== 게임 캔버스 자동 맞춤 =====
  function fitGameCanvas() {
    const canvas = document.getElementById('game-canvas');
    if (!canvas) return;

    const dpr = window.devicePixelRatio || 1;

    // 상단 UI(헤더+탭) 높이 측정
    const header = document.querySelector('header');
    const nav = document.querySelector('.nav-container');
    const topChrome = (header?.offsetHeight || 0) + (nav?.offsetHeight || 0) + 32; // 여유 패딩
    const availH = Math.max(200, window.innerHeight - topChrome - 16);

    // 컨텐츠 가로폭
    const content = document.getElementById('content-area');
    const maxW = (content?.clientWidth || canvas.parentElement?.clientWidth || window.innerWidth);

    // 게임 고정 비율 (8/5 = 1.6)
    const aspect = 8 / 5;

    // 가용 높이/너비에 맞게 계산
    let targetW = Math.min(maxW, Math.floor(availH * aspect));
    let targetH = Math.floor(targetW / aspect);
    if (targetH > availH) { targetH = availH; targetW = Math.floor(targetH * aspect); }

    // CSS 크기 적용
    canvas.style.width = targetW + 'px';
    canvas.style.height = targetH + 'px';

    // 내부 해상도(dpr 반영) 적용 → 흐림 방지
    const needW = Math.floor(targetW * dpr);
    const needH = Math.floor(targetH * dpr);
    if (canvas.width !== needW || canvas.height !== needH) {
      canvas.width = needW;
      canvas.height = needH;
      const ctx = canvas.getContext('2d');
      if (ctx && dpr !== 1) ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      // ⚠️ 게임 렌더 코드에서 자체 스케일을 쓰면 setTransform은 빼세요.
    }
  }

  // 창/회전/탭 전환 시 반응
  window.addEventListener('resize', fitGameCanvas);
  window.addEventListener('orientationchange', fitGameCanvas);
  document.addEventListener('visibilitychange', () => { if (!document.hidden) setTimeout(fitGameCanvas, 0); });

  // "타이핑 게임" 탭 클릭 후 렌더가 끝났을 타이밍에 맞춰 재적용
  document.addEventListener('click', (e) => {
    const t = e.target.closest?.('[data-tab="game"]');
    if (t) setTimeout(fitGameCanvas, 0);
  });

  // 첫 로드 시 한 번
  setTimeout(fitGameCanvas, 0);

</script>

<!-- ===== Admin Delete Module v3 (lockup-safe, COOP-safe, idempotent) ===== -->

<!-- ===== Admin Delete Module v4 (popup login + logout, guestbook-only, idempotent) ===== -->
<script type="module" id="admin-delete-v4">
import { getApps, getApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";
import { getFirestore, collection, getDocs, deleteDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

// Reuse existing Firebase app
const app = getApps()[0] || getApp();
const auth = getAuth(app);
const db   = getFirestore(app);

// Global admin flag
window.__isAdmin = !!window.__isAdmin;

// RAF-throttled UI update
let rafQueued = false;
function scheduleUIUpdate() {
  if (rafQueued) return;
  rafQueued = true;
  requestAnimationFrame(() => {
    rafQueued = false;
    injectAuthButtons();
    attachDeleteButtons();
  });
}

// expose refresh hooks for tab switching
window.__gbAdminRefresh = scheduleUIUpdate;
// expose refresh hooks for tab switching
window.__gbAdminRefresh = scheduleUIUpdate;



function isGoogleSession() {
  const u = auth.currentUser;
  if (!u || u.isAnonymous) return false;
  const pd = Array.isArray(u.providerData) ? u.providerData : [];
  return pd.some(p => p && p.providerId === "google.com");
}

// Buttons at guestbook toolbar
function injectAuthButtons() {
  const sortSel = document.getElementById("guestbook-sort");
  if (!sortSel) return;
  const host = sortSel.parentElement || sortSel;

  let inBtn = document.getElementById("adminSignIn");
  if (!inBtn) {
    inBtn = document.createElement("button");
    inBtn.id = "adminSignIn";
    inBtn.type = "button";
    inBtn.textContent = "관리자 로그인";
    inBtn.className = "ml-2 px-3 py-2 rounded-lg bg-slate-700 text-white text-sm hover:bg-slate-800";
    host.appendChild(inBtn);
  }

  let outBtn = document.getElementById("adminSignOut");
  if (!outBtn) {
    outBtn = document.createElement("button");
    outBtn.id = "adminSignOut";
    outBtn.type = "button";
    outBtn.textContent = "로그아웃";
    outBtn.className = "ml-2 px-3 py-2 rounded-lg bg-slate-500 text-white text-sm hover:bg-slate-600";
    outBtn.style.display = "none";
    host.appendChild(outBtn);
  }

  // Re-bind events (avoid duplicate handlers by cloning)
  const inClone = inBtn.cloneNode(true);
  inBtn.parentNode.replaceChild(inClone, inBtn);
  inClone.addEventListener("click", async () => {
    const provider = new GoogleAuthProvider();
    try {
      await signInWithPopup(auth, provider);
    } catch (e) {
      try { await signInWithRedirect(auth, provider); }
      catch(e2) { alert("관리자 로그인 실패: " + (e2 && e2.message ? e2.message : e2)); }
    }
  }, { once: true });

  const outClone = outBtn.cloneNode(true);
  outBtn.parentNode.replaceChild(outClone, outBtn);
  outClone.addEventListener("click", async () => {
    try {
      await signOut(auth);
      window.__isAdmin = false;
      // Remove delete buttons if any
      const list = document.getElementById("guestbook-list");
      if (list) list.querySelectorAll(".gb-delete").forEach(el => el.remove());
      scheduleUIUpdate();
    } catch (e) {
      alert("로그아웃 실패: " + (e && e.message ? e.message : e));
    }
  }, { once: true });

  const google = isGoogleSession();
  inClone.style.display  = google ? "none" : "";
  outClone.style.display = google ? "" : "none";
}

// Admin flag check (non-blocking)
async function refreshAdminFlag() {
  const u = auth.currentUser;
  if (!u || !isGoogleSession()) { window.__isAdmin = false; scheduleUIUpdate(); return; }
window.__gbAdminRefreshAuth = refreshAdminFlag;
  try {
    const snap = await getDoc(doc(db, "admins", u.uid));
    window.__isAdmin = !!(snap.exists() && snap.data() && snap.data().isAdmin === true);
  } catch (e) {
    window.__isAdmin = false;
  }
  scheduleUIUpdate();
}

// Delete helper (votes/* -> main doc)
window.deleteGuestbookWithVotes = async function(entryId) {
  const votesRef = collection(db, "guestbook", entryId, "votes");
  const snap = await getDocs(votesRef);
  const tasks = [];
  snap.forEach(d => tasks.push(deleteDoc(doc(db, "guestbook", entryId, "votes", d.id))));
  await Promise.all(tasks);
  await deleteDoc(doc(db, "guestbook", entryId));
};

// Attach delete buttons (idempotent)
function attachDeleteButtons() {
  if (!window.__isAdmin) return;
  const list = document.getElementById("guestbook-list");
  if (!list) return;

  const cards = list.querySelectorAll(".card, .rounded-xl.border, [data-gb-item]");
  const collectionLike = cards.length ? cards : list.children;

  Array.from(collectionLike).forEach(card => {
    if (card.dataset.gbDeleteBound === "1") return;

    const likeBtn = card.querySelector('.gb-like, [data-type="like"]');
    const id = (likeBtn && likeBtn.getAttribute("data-id")) || card.getAttribute("data-id");
    if (!id) return;

    let headerRight =
      card.querySelector(".flex.items-center.gap-2") ||
      card.querySelector(".flex.justify-between .flex.items-center") ||
      card.querySelector(".flex.justify-between > div:last-child") ||
      card;

    if (!card.querySelector(".gb-delete")) {
      const btn = document.createElement("button");
      btn.className = "gb-delete text-sm text-red-600 ml-2";
      btn.type = "button";
      btn.textContent = "🗑️ 삭제";
      btn.addEventListener("click", async () => {
        if (!window.__isAdmin) return alert("관리자만 삭제할 수 있습니다.");
        if (!confirm("이 글을 삭제할까요? 되돌릴 수 없습니다.")) return;
        try { await window.deleteGuestbookWithVotes(id); }
        catch(e){ alert("삭제 실패: " + (e && e.message ? e.message : e)); }
      });
      headerRight.appendChild(btn);
    }
    card.dataset.gbDeleteBound = "1";
  });
}

// Observe guestbook list for changes (no self-trigger loops)
const listObserver = new MutationObserver(() => scheduleUIUpdate());
const rootObserver = new MutationObserver(() => {
  const list = document.getElementById("guestbook-list");
  if (list && !listObserver._observing) {
    listObserver.observe(list, { childList: true, subtree: true });
    listObserver._observing = true;
    scheduleUIUpdate();
  }
});
rootObserver.observe(document.documentElement, { childList: true, subtree: true });

// Handle redirect result (COOP-safe)
getRedirectResult(auth).then(() => refreshAdminFlag()).catch((e)=>{});

// Auth state changes
onAuthStateChanged(auth, () => refreshAdminFlag());

// Initial kick
setTimeout(() => refreshAdminFlag(), 500);

// Re-sync UI when user switches tabs or URL hash changes (guestbook <-> ranking)
document.addEventListener("click", (e) => {
  const t = e.target && (e.target.closest ? e.target.closest('[data-tab]') : null);
  if (t) {
    setTimeout(() => {
      if (typeof window.__gbAdminRefreshAuth === "function") window.__gbAdminRefreshAuth();
      if (typeof window.__gbAdminRefresh === "function") window.__gbAdminRefresh();
    }, 80);
  }
});
window.addEventListener("hashchange", () => {
  if (typeof window.__gbAdminRefreshAuth === "function") window.__gbAdminRefreshAuth();
  if (typeof window.__gbAdminRefresh === "function") window.__gbAdminRefresh();
});

</script>


</body>
</html>
